<?php
$mal_kontaktadresse="gigacampus@uninett.no"; // obligatorisk
$mal_temabilde="teknisk";                     // obligatorisk, se liste på
                                        // www.uninett.no/info/info/bilder.html
$mal_blurb="";          // valgfritt (tekst under bilde) 
$mal_kontekst="";                       // valgfritt
$mal_overskrift="Brukerdokumentasjon Verktøykasser"; // obligatorisk
$mal_modus="";                          // valgfritt
$mal_tittel="";                         // valgfritt, normalt blir tittelen
                                        // tjener: kontekst - overskrift - modus
include "uninetttopp.php3";
?>

<dl>
  <dt>REVISJON:
  <dd>Verktøykasse-brukerdok.2006.01
  <dt>ANSVARLIG:
  <dd>Vidar.Faltinsen@uninett.no
  <dt>DATO:
  <dd>2006-10-10
</dl>

<hr>

<p align=center>
[<a href="#Brukertilgang">Brukertilgang</a>]
[<a href="#tftp">tftp</a>]
[<a href="#radius">Radius</a>]
[<a href="#syslog">Syslog</a>]
[<a href="#nav">NAV</a>]
[<a href="#netflow">Netflow</a>]
</p>

<h2>Innledning</h2>
<p>
 
Dette dokument er myntet på lokalt IKT driftspersonell ved
høgskole/universitet som er bruker av verktøykassen.
Verktøykassene er som kjent drevet fra UNINETT. Driftsinstruks
for UNINETT beredskapsvakt 
<a 
href="http://drift.uninett.no/rutiner/verktoykasser.html">foreligger
i tillegg.</a> For en generell beskrivelse av verktøykassene se
<a href="http://www.gigacampus.no/verktoykasse.html">her</a>.

</p><p> 
For å benytte flere av tjenestene på verktøykassen kreves naturlig nok
relevant konfigurasjon av nettutstyret. Vi viser til følgende
UNINETT fagspesifikasjoner:

<ul>
<li> <a href="http://wiki.uninett.no/gigacampus/UFS105">
Anbefalt konfigurasjon for svitsjer i campusnett (UFS105)</a>
<li> <a href="http://wiki.uninett.no/gigacampus/UFS109">Cisco IOS 
kokebok (UFS109)</a>
<li> <a 
href="http://wiki.uninett.no/gigacampus/UFS110">Alcatel kokebok 
(UFS110)</a>
<li> <a href="http://wiki.uninett.no/gigacampus/UFS111">HP 
kokebok (UFS111)</a>
</ul>

Vi minner også om at svitsjene i campusnettet bør (les: må) være på
en forsvarlig programvareversjon. 
<a href="http://drift.uninett.no/utstyr/svitsj/oppgradering-sw.mhtml">
Følgende lenke</a> gir en oversikt per plattform.

<h2><a name="Brukertilgang">Brukertilgang til verktøykassen</a></h2>

<p>
For å logge inn på verktøykassen med ssh må du ha bruker.
Du bør være medlem av gruppen <tt>netsys</tt>, da det bl.a. gir 
filrettigheter under <tt>/tftpboot</tt>. Videre vil du om du kjører
<tt>/bin/bash</tt> få satt hensiktsmessig <tt>umask</tt> for 
tftp-tjenesten.
</p><p> 
 
For å legge til ny bruker gjør administrator:
<pre>
  useradd -g netops -m -s /bin/bash nyfyr
  passwd nyfyr
</pre>
<p>
Merk at det er det samme passord som blir brukt ved 
radiusantentisering mot nettelektronikken.
</p>

<h2><a name="tftp">tftp</a></h2>

<p>
tftp-tjenesten gjør det mulig å skrive og laste konfigurasjon 
til/fra nettutstyret. tftp-demonen er sikret med en 
konfigurasjonsfil <tt>/tftpboot/tftpd.conf</tt>. For å forenkle 
vedlikehold blir denne filen autogenerert etter følgende kjøreregler.
</p><p> 
Når en ny svitsj skal legges til i tftp konfigurasjonen:
<ol>
<li> Legg til svitsjen i <tt>/tftpboot/tftpd.txt</tt>
     Syntaks sees lett i fila: 
<pre>
	 "svitsj"        "ipadresse"
</pre>
<li> Etter at fila redigert, kjør <tt>make</tt> (du står på 
<tt>/tftpboot</tt>)
     Vips, så er ny <tt>tftp.conf</tt> laget. Du kan da skrive 
konfigurasjon
     for den nye boksen til verktøykassa!
</ol>
Tilsvarende kan bokser slettes fra <tt>tftpd.txt</tt> / 
<tt>tftpd.conf</tt>. 
<ul>
<li> Merk: På sikt vil vi søke å automatisere
denne manuelle vedlikeholdsprosessen ved å bruke NAV som kilde.
Dvs at du kun legger inn utstyr i NAV, utstyret vil da automagisk
kunne bruke tftp-tjenesten.
</ul>
<p> 

For å bevare historikk på konfigurasjon benyttes RCS. Opplegget
er automatisert ved at en nattlig cronjobb sjekker inn
ny versjon av alle filer som er endret. I tillegg rapporteres 
alle endringene i epost til mottager angitt som
<tt>nocoperators</tt> i fila <tt>/etc/default/uninett.conf</tt>
(merk at denne filen er styrt av uninetts cfengine, ta kontakt
med drift@uninett.no for å få gjort endringer).
</p><p> 

<ul>
<li> I tillegg til konfigurasjoner ligger også aksesslistefiler
på <tt>/tftpboot</tt>. Vedlikehold av disse og arbeid med aksesslister
generelt er ikke omtalt her.
<li> En nattlig cronjobb sørger for å kopiere konfigurasjoner fra
verktøykassa til trane.uninett.no, som er UNINETTs sentrale
konfigurasjonsserver. 
<li> En siste ting som ligger på <tt>/tftpboot</tt> er software imager.
Disse kan lastes til svitsjer for oppgradering.
</ul>

<h4>ftp / scp </h4>

tftp duger ikke ved oppgradering av store software imager (over 32MB).
Da kan man benytte ftp, evt scp. Vi håper at man klarer seg med
scp og har ikke satt opp ftp tjener på verktøykassen per dags dato.

<h2><a name="radius">Radius</a></h2>

<p>
Det er ingen bruker-konfigurasjon forbundet med radius som trengs å
konfigureres på verktøykassene. Dette fordi radius er satt opp
til bruke <tt>/etc/passwd</tt> som sin brukerkilde. Dersom brukerne her
har satt passord blir dette benyttet ved radiusautentisering.
Dersom bruker på nettutstyret logger seg på med <tt>@uninett.no</tt> 
endelse så er radiustjener på verktøykassen satt opp til
å relee forespørsel til radiustjener på trane.uninett.no. 
Således kan UNINETT drift komme inn (dersom ønskelig).
</p><p> 
 
Det som imidlertid må konfigureres (og dette gjøres i uninetts cfengine 
oppsett, ta kontakt med drift@uninett.no) er 
<tt>/etc/freeradius/clients.conf</tt>
</p><p> 
 
Eksempel fra hil;

<pre> 
client 128.39.109.0/26 {
   secret       = felles-hemmelighet
   shortname    = hil-mngmt
} 
</pre>
</p><p> 
 
Det vi angir her at alle svitsjene i området 128.39.109.1-63 tillates
å snakke radius med verktøykassen gitt at de er konfigurert med
samme felles-hemmelighet.
</p>
 
 
<h2><a name="syslog">Syslog</a></h2>

All nettelektronikk bør syslogge til verktøykassa. 
Syslog er satt opp slik at nettelektronikk logger til to filer;
<pre> 
/var/log/network.log
/var/log/network_nav.log
</pre>

Sistnevnte fil blir igjen lest og tømt av NAV sin bakgrunnsprosess
logengine som kjører en gang i minuttet. Dataene blir lagt i NAVdb 
sin 
syslog-database og er igjen søkbare gjennom NAVs syslog analyzer tool.
</p><p> 
 
<tt>network.log</tt> blir ikke tømt, men komprimert og rotert en gang i 
døgnet. Dere kan således velge å søke i syslog i tekstmodus, direkte på
verktøykassen, eller via NAV.
</p>

<h2><a name="nav">NAV</a></h2>

NAV er omfattende å forklare. Vi vil her videreutvikle
dokumentasjonen på 
 <a 
href="http://metanav.ntnu.no">NAV wiki</a>
og henviser foreløbig bare til denne.

<h2><a name="netflow">Netflow</a></h2>

Her kommer info...

<h2><a name="Kontaktpunkt">Kontaktpunkt</a></h2>

<ul>
<li>drift@uninett.no</li>
</ul>

<?php
include "uninettbunn.php3";
?>

