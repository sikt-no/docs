"use strict";(self.webpackChunkdocs_sikt_no=self.webpackChunkdocs_sikt_no||[]).push([[7351],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var o=r.createContext({}),d=function(e){var n=r.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=d(e.components);return r.createElement(o.Provider,{value:n},e.children)},k={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},f=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,l=e.originalType,o=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),f=d(t),m=a,u=f["".concat(o,".").concat(m)]||f[m]||k[m]||l;return t?r.createElement(u,i(i({ref:n},p),{},{components:t})):r.createElement(u,i({ref:n},p))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var l=t.length,i=new Array(l);i[0]=f;var s={};for(var o in n)hasOwnProperty.call(n,o)&&(s[o]=n[o]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var d=2;d<l;d++)i[d]=t[d];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}f.displayName="MDXCreateElement"},4140:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>k,frontMatter:()=>l,metadata:()=>s,toc:()=>d});var r=t(7462),a=(t(7294),t(3905));const l={description:"Om responsen fra et API inneholder informasjon som er beskyttelsesverdig og som ikke alle konsumenter trenger kan man legge p\xe5 en enkel policy som fjerner felt fra responsen.\n\n\nOm der er et eget-utviklet API er det bedre \xe5 endre i APIet. Og selv om man ikke kan endre p\xe5 et API: er det\xa0 behov for st\xf8rre endringer i responsen til et API er det oftest bedre \xe5 gj\xf8re dette utenfor API manageren, feks. ved \xe5 ha en liten mikrotjeneste mellom API manager og backend-APIet.\n\n\nMen mindre endringer, f.eks. for \xe5 fjerne enkelte felt, er policy-en\xa0 JSON to JSON transformation en rask og enkel m\xe5te \xe5 filtere bort innhold man vil beskytte",title:"Filtrere bort innhold i responsen fra et API"},i="Filtrere bort innhold i responsen fra et API",s={unversionedId:"datadeling/veiledere/api-manager/filtrere-innhold-json",id:"datadeling/veiledere/api-manager/filtrere-innhold-json",title:"Filtrere bort innhold i responsen fra et API",description:"Om responsen fra et API inneholder informasjon som er beskyttelsesverdig og som ikke alle konsumenter trenger kan man legge p\xe5 en enkel policy som fjerner felt fra responsen.\n\n\nOm der er et eget-utviklet API er det bedre \xe5 endre i APIet. Og selv om man ikke kan endre p\xe5 et API: er det\xa0 behov for st\xf8rre endringer i responsen til et API er det oftest bedre \xe5 gj\xf8re dette utenfor API manageren, feks. ved \xe5 ha en liten mikrotjeneste mellom API manager og backend-APIet.\n\n\nMen mindre endringer, f.eks. for \xe5 fjerne enkelte felt, er policy-en\xa0 JSON to JSON transformation en rask og enkel m\xe5te \xe5 filtere bort innhold man vil beskytte",source:"@site/docs/datadeling/veiledere/api-manager/filtrere-innhold-json.md",sourceDirName:"datadeling/veiledere/api-manager",slug:"/datadeling/veiledere/api-manager/filtrere-innhold-json",permalink:"/docs/datadeling/veiledere/api-manager/filtrere-innhold-json",draft:!1,editUrl:"https://github.com/sikt-no/docs/tree/master/docs/datadeling/veiledere/api-manager/filtrere-innhold-json.md",tags:[],version:"current",lastUpdatedAt:1677681114,formattedLastUpdatedAt:"Mar 1, 2023",frontMatter:{description:"Om responsen fra et API inneholder informasjon som er beskyttelsesverdig og som ikke alle konsumenter trenger kan man legge p\xe5 en enkel policy som fjerner felt fra responsen.\n\n\nOm der er et eget-utviklet API er det bedre \xe5 endre i APIet. Og selv om man ikke kan endre p\xe5 et API: er det\xa0 behov for st\xf8rre endringer i responsen til et API er det oftest bedre \xe5 gj\xf8re dette utenfor API manageren, feks. ved \xe5 ha en liten mikrotjeneste mellom API manager og backend-APIet.\n\n\nMen mindre endringer, f.eks. for \xe5 fjerne enkelte felt, er policy-en\xa0 JSON to JSON transformation en rask og enkel m\xe5te \xe5 filtere bort innhold man vil beskytte",title:"Filtrere bort innhold i responsen fra et API"},sidebar:"datadeling",previous:{title:"Caching i gravitee",permalink:"/docs/datadeling/veiledere/api-manager/caching-gravitee"},next:{title:"Godkjenne tilgang til API",permalink:"/docs/datadeling/veiledere/api-manager/godkjenne-tilgang-til-api"}},o={},d=[{value:"Introduksjon",id:"introduksjon",level:2},{value:"Eksempel 1: Respons fra et API med ett objekt",id:"eksempel-1-respons-fra-et-api-med-ett-objekt",level:3},{value:"Eksempel 2: Respons fra et API med flere objekt",id:"eksempel-2-respons-fra-et-api-med-flere-objekt",level:3},{value:"Eksempel 3: respons fra et API gitt en spesifikk verdi",id:"eksempel-3-respons-fra-et-api-gitt-en-spesifikk-verdi",level:3},{value:"Eksempel 4: Svar med default-verdi",id:"eksempel-4-svar-med-default-verdi",level:3}],p={toc:d};function k(e){let{components:n,...l}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,l,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"filtrere-bort-innhold-i-responsen-fra-et-api"},"Filtrere bort innhold i responsen fra et API"),(0,a.kt)("p",null,"Om responsen fra et API inneholder informasjon som er beskyttelsesverdig og som ikke alle konsumenter trenger kan man legge p\xe5 en enkel policy som fjerner felt fra responsen."),(0,a.kt)("p",null,"Om det er et eget-utviklet API er det bedre \xe5 endre i selve API-et. Og selv om man ikke kan endre p\xe5 et API: er det behov for st\xf8rre endringer i responsen til et API er det bedre \xe5 gj\xf8re dette utenfor API manageren, feks. ved \xe5 ha en liten mikrotjeneste mellom API manager og backend-API-et."),(0,a.kt)("p",null,"Med mindre endringer, f.eks. for \xe5 fjerne enkelte felt, egner policyen JSON to JSON transformation seg godt. Dette er en rask og enkel m\xe5te \xe5 filtere bort innhold man vil beskytte."),(0,a.kt)("h2",{id:"introduksjon"},"Introduksjon"),(0,a.kt)("p",null,"Her konfigureres policyen JSON to JSON transformation. Hvis filtreringen skal gjelde alle som benytter APIet, ",(0,a.kt)("a",{parentName:"p",href:"/docs/datadeling/veiledere/api-manager/legge-pa-enkel-policy"},"legg p\xe5 policy som beskrevet her.")),(0,a.kt)("p",null,'Om filtreringen skal gjelde en enkel plan, slik at man kan ha en plan som gir all informasjon i svaret og en annen plan som kun gir \xe5pen informasjon i svar, legg til policyen p\xe5 siste side i veiviseren, punkt 4 "Policies", for \xe5 opprette/endre plan.'),(0,a.kt)("p",null,'I nedtrekksmenyen hvor det st\xe5r "Select policy", velg JSON to JSON transformation og trykk "ADD".'),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Legge policy p\xe5 plan i gravitee",src:t(8859).Z,width:"1371",height:"764"})),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"json to json policy",src:t(7006).Z,width:"1015",height:"958"})),(0,a.kt)("p",null,'For Scope, velg "RESPONSE".'),(0,a.kt)("p",null,"I feltet for JOLT spesification spesifiserer du hva som skal endres i JSON filen."),(0,a.kt)("p",null,"Denne policyen benytter ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/bazaarvoice/jolt"},"open source-prosjektet JOLT")),(0,a.kt)("p",null,"Dette kan ",(0,a.kt)("a",{parentName:"p",href:"http://jolt-demo.appspot.com"},"testes p\xe5 denne web-siden")," om det er \xf8nskelig."),(0,a.kt)("h3",{id:"eksempel-1-respons-fra-et-api-med-ett-objekt"},"Eksempel 1: Respons fra et API med ett objekt"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'{\n  "ansatt": {\n    "id": "00102099",\n    "brukerident": null,\n    "dfoBrukerident": null,\n    "eksternIdent": null,\n    "fornavn": "Kjell-Arne",\n    "etternavn": "Testesen",\n    "fnr": "29078729585",\n    "annenId": [\n      null\n    ],\n    "fdato": "1987-07-29"\n  }\n}\n')),(0,a.kt)("p",null,'For \xe5 fjerne n\xf8kkelel "fnr" og tilknyttet verdi konfigurer vi policyen slik:'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'[\n  {\n    "operation": "remove",\n    "spec": {\n      "ansatt": {\n        "fnr": ""\n      }\n    }\n  }\n]\n')),(0,a.kt)("p",null,"Kaller man API-et etter at denne policyen er lagt p\xe5, f\xe5r man i stedet denne responsen:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'{\n  "ansatt": {\n    "id": "00102099",\n    "brukerident": null,\n    "dfoBrukerident": null,\n    "eksternIdent": null,\n    "fornavn": "Kjell-Arne",\n    "etternavn": "Testesen",\n    "annenId": [\n      null\n    ],\n    "fdato": "1987-07-29"\n  }\n}\n')),(0,a.kt)("h3",{id:"eksempel-2-respons-fra-et-api-med-flere-objekt"},"Eksempel 2: Respons fra et API med flere objekt"),(0,a.kt)("p",null,"Mange API-er gir enkeltsvar tilbake som et enkelt objekt, men kall som finner flere objekter gir tilbake en liste med objekter:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'{\n  "ansatt": [\n    {\n      "id": "00102099",\n      "brukerident": null,\n      "dfoBrukerident": null,\n      "eksternIdent": null,\n      "fornavn": "Kjell-Arne",\n      "etternavn": "Testesen",\n      "annenId": [\n         null\n      ],\n      "fdato": "1987-07-29"\n    },\n    {\n      "id": "00100982",\n      "brukerident": null,\n      "fornavn": "Martin",\n      "etternavn": "Martinsen",\n      "fnr": "23456789",\n      "fdato": "1973-11-06"\n    }\n  ]\n}\n')),(0,a.kt)("p",null,'For \xe5 filtrere bort "fnr" fra denne kan man benytte f\xf8lgende spesifisering:'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'[\n  {\n    "operation": "remove",\n    "spec": {\n      "ansatt": {\n        "*": {\n          "fnr": ""\n        },\n        "fnr": ""\n      }\n    }\n  }\n]\n')),(0,a.kt)("p",null,"Denne spesifiseringen vil fungere b\xe5de p\xe5 det f\xf8rste og andre eksemplet."),(0,a.kt)("h3",{id:"eksempel-3-respons-fra-et-api-gitt-en-spesifikk-verdi"},"Eksempel 3: respons fra et API gitt en spesifikk verdi"),(0,a.kt)("p",null,"Noen ganger vil man kun returnere svar ut i fra et API dersom det i svaret forekommer en spesifikk verdi. Gitt at API-et gir f\xf8lgende respons:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'{\n  "id": "5001234",\n  "navn": "Ola Nordmann",\n  "info": "Informasjon som noen ganger er unntatt offentligheten",\n  "unntattOff": "False"\n}\n\n')),(0,a.kt)("p",null,'Og vi vil returnere denne responsen, men kun dersom feltet "unntattOff" ikke har verdien "True".'),(0,a.kt)("p",null,'F\xf8lgende JOLT-spesifikasjon vil kun tillate svar der hvor verdien i "unntattOff" er "False":'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'[\n  {\n    "operation": "shift",\n    "spec": {\n      "unntattOff": {\n        "False": {\n          "@2": ""\n        }\n      }\n    }\n  }\n]\n')),(0,a.kt)("p",null,"Om responsen fra API-et er som f\xf8lger:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'{\n  "id": "5001234",\n  "navn": "Ola Nordmann",\n  "info": "Dette er hemmelig",\n  "unntattOff": "True"\n}\n')),(0,a.kt)("p",null,"Da vil svaret fra Gravitee med denne policyen p\xe5 planen/API-et v\xe6re:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},"null\n")),(0,a.kt)("p",null,'Merk at slik som vi har konfigurert JOLT-spesifikasjonen s\xe5 tar vi med svaret kun hvis "unntattOff" er "False". Om det har verdien "Nei" eller er tomt vil det ikke bli tatt med. Det er ogs\xe5 mulig \xe5 erstatte innholdet med en tom verdi om "unntattOff" er "True", og returnere svar om det har en hvilken som helst annen verdi, eller ingen verdi, men da risikerer man \xe5 returnere svar som ikke skulle v\xe6rt med om "unntattOff" ved en feil eller en kodeendring er tomt, f\xe5r verdien "Ja" eller har endret stor/liten bokstav til TRUE eller true.'),(0,a.kt)("p",null,'Merk at spesifikasjonen ikke vil returnere svar om n\xf8kkelen "unntattOff" mangler helt.'),(0,a.kt)("h3",{id:"eksempel-4-svar-med-default-verdi"},"Eksempel 4: Svar med default-verdi"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'[\n  {\n    "operation": "shift",\n    "spec": {\n      "unntattOff": {\n        "true": {\n          "": ""\n        },\n        "*": { "@2": "" }\n      }\n    }\n  }\n]\n')),(0,a.kt)("p",null,'Om en n\xf8kkel kun er med hvis den har en verdi vil ikke dette eksempelet returnere noe svar. Feks. om "unntattOff" kun er med i svaret om det har verdien "true" eller om det kun er med om noen eksplisitt har valgt "true" eller "false". I disse tilfellene vil ingen av konfigurasjonene i dette eksempelet fungere. Det man kan gj\xf8re i en slik situasjon er \xe5 sette en default-verdi f\xf8rst, og deretter shift-operasjonen:'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'[\n  {\n    "operation": "default",\n    "spec": {\n      "unntattOff": "false"\n    }\n  },\n  {\n    "operation": "shift",\n    "spec": {\n      "unntattOff": {\n        "true": {\n          "": ""\n        },\n        "*": { "@2": "" }\n      }\n    }\n  }\n]\n')),(0,a.kt)("p",null,"Merk at n\xf8kkel/verdien som blir lagt til vil bli med i svaret som g\xe5r til mottakeren."),(0,a.kt)("p",null,"Disse eksemplene vil, i likhet med eksempel 1, ikke fungere om man f\xe5r svar med flere objekter i en liste. For slike tilfeller kan man heller bruke:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'[\n  {\n    "operation": "shift",\n    "spec": {\n      "unntattOff": {\n        "false": {\n          "@2": ""\n        }\n      },\n      "*": {\n        "unntattOff": {\n          "false": {\n            "@2": ""\n          }\n        }\n      }\n    }\n  }\n]\n')),(0,a.kt)("p",null,"For \xe5 sette inn default-verdier i et array m\xe5 det spesifiseres at det er et array ved \xe5 legge p\xe5 [] i slutten av navnet."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'{\n  "ressurser":\n [\n  {\n   "id": "5001234",\n   "navn": "Kari Nordmann",\n   "info": "Informasjon  er unntatt offentligheten",\n   "unntattOff": "True"\n  },\n  {\n   "id": "5001235",\n   "navn": "Ola Nordmann",\n   "info": "Informasjon som ikke er unntatt offentligheten"\n  }\n ]\n}\n')),(0,a.kt)("p",null,"Bruk"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Text"},'[\n    {\n    "operation": "default",\n    "spec": {\n      "ressurser[]":{\n        "*":{\n          "unntattOff": "false"\n        }\n      }\n    }\n  },\n  {\n    "operation": "shift",\n    "spec": {\n      "ressurser":{\n        "*": {\n          "unntattOff": {\n            "false": {\n              "@2": "ressurser"\n            }\n          }\n        }\n      }\n    }\n  }\n]\n')))}k.isMDXComponent=!0},8859:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/image-20210126164247-1-48c560105fdefac59e243e2f5fef8fd9.png"},7006:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/image-20210126175724-2-16f06cdebfd5a9918c6566f76271318b.png"}}]);