"use strict";(self.webpackChunkdocs_sikt_no=self.webpackChunkdocs_sikt_no||[]).push([[2669],{5257:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>s,default:()=>m,frontMatter:()=>l,metadata:()=>d,toc:()=>a});var t=n(4848),i=n(8453);const l={title:"Firewall builder",last_update:{date:new Date("2011-09-30T00:00:00.000Z"),author:"rune.sydskjor@sikt.no"}},s=void 0,d={id:"nettadministrasjon/fwbuilder",title:"Firewall builder",description:"Innledning",source:"@site/docs/nettadministrasjon/fwbuilder.md",sourceDirName:"nettadministrasjon",slug:"/nettadministrasjon/fwbuilder",permalink:"/docs/nettadministrasjon/fwbuilder",draft:!1,unlisted:!1,editUrl:"https://github.com/sikt-no/docs/tree/master/docs/nettadministrasjon/fwbuilder.md",tags:[],version:"current",lastUpdatedAt:13173408e5,frontMatter:{title:"Firewall builder",last_update:{date:"2011-09-30T00:00:00.000Z",author:"rune.sydskjor@sikt.no"}},sidebar:"nettadministrasjon",previous:{title:"Xymon-integrasjon p\xe5 verkt\xf8ykasser",permalink:"/docs/nettadministrasjon/xymon"}},o={},a=[{value:"Innledning",id:"innledning",level:2},{value:"Komme igang med programmet, og f\xe5 filer inn i RCS",id:"komme-igang-med-programmet-og-f\xe5-filer-inn-i-rcs",level:2},{value:"Definere ruter(e)",id:"definere-rutere",level:2},{value:"Lage filter for et gitt interface",id:"lage-filter-for-et-gitt-interface",level:2},{value:"Gruppere interface",id:"gruppere-interface",level:2},{value:"Eksempel p\xe5 oppsett",id:"eksempel-p\xe5-oppsett",level:2},{value:"Legge over filter til ruteren",id:"legge-over-filter-til-ruteren",level:2},{value:"Tips og triks",id:"tips-og-triks",level:2},{value:"Kontaktpersoner",id:"kontaktpersoner",level:2}];function g(e){const r={a:"a",code:"code",em:"em",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.h2,{id:"innledning",children:"Innledning"}),"\n",(0,t.jsxs)(r.p,{children:["Lange og komplekse pakkefilter, redundante rutere og introduksjon av\nIPv6 har gjort at det er n\xf8dvendig \xe5 se p\xe5 alternative m\xe5ter \xe5 lage\npakkefilter p\xe5. Firewall builder (fwbuilder) er installert p\xe5\nverkt\xf8ykassene, og kan brukes til \xe5 h\xe5ndtere blant annet Cisco\naksesslister. Denne dokumentasjonen er skrevet basert p\xe5 hvordan UNINETT\nhar tatt ibruk fwbuilder lokalt hos seg. Fremgangsm\xe5ten som brukes og\nl\xf8sningene man kommer frem til kan selvf\xf8lgelig v\xe6re helt forskjellig\nifra det vi har gjort. Denne dokumentasjonen er alts\xe5 ment som tips til\nhvordan man kommer igang, og enkelte ting man b\xf8r v\xe6re obs p\xe5. For mer\ninformasjon om Firewall builder, se ",(0,t.jsx)(r.a,{href:"http://www.fwbuilder.org/",children:"fwbuilder sine\nhjemmesider."})]}),"\n",(0,t.jsxs)(r.p,{children:['Fremgangsm\xe5ten for \xe5 etablere filter via firewall builder er lik m\xe5ten\nman gj\xf8r det med "manuelle filter", og her er tips til hvordan det\ngj\xf8res: ',(0,t.jsx)(r.a,{href:"https://ow.feide.no/_media/gigacampus:ufs:ufs_106.pdf",children:"UFS 106"})]}),"\n",(0,t.jsx)(r.h2,{id:"komme-igang-med-programmet-og-f\xe5-filer-inn-i-rcs",children:"Komme igang med programmet, og f\xe5 filer inn i RCS"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Logg inn p\xe5 verkt\xf8ykassen med din ssh-klient. Husk at X11-forwarding\nm\xe5 v\xe6re p\xe5sl\xe5tt."}),"\n",(0,t.jsxs)(r.li,{children:["Programmet startes med ",(0,t.jsx)(r.code,{children:"fwbuilder"})]}),"\n",(0,t.jsx)(r.li,{children:"Opprett en firewall eller gj\xf8r noe sm\xe5tteri som gj\xf8r at du kan lagre\ndet du har gjort som ei fil."}),"\n",(0,t.jsxs)(r.li,{children:["Lagre fila under vk:",(0,t.jsx)(r.code,{children:"/tftpboot/"})]}),"\n",(0,t.jsx)(r.li,{children:"G\xe5 ut av programmet"}),"\n",(0,t.jsxs)(r.li,{children:["Fra terminalvinduet st\xe5ende i tftpboot, sjekk inn den nye fila med\n",(0,t.jsx)(r.code,{children:"ci -u 'filnavn'"}),", og skriv inn en kommentar"]}),"\n",(0,t.jsxs)(r.li,{children:["Neste gang starter du n\xe5 programmet med ",(0,t.jsx)(r.code,{children:"fwbuilder 'filnavn'"}),". N\xe5r du\nn\xe5 kommer inn i firewall builder vil du f\xe5 oversikt over alle\ntidligere revisjoner, og kommentarene som er skrevet inn for hvilke\nendringer som er gjort"]}),"\n",(0,t.jsx)(r.li,{children:"Du vil heretter f\xe5 sp\xf8rsm\xe5l om \xe5 sjekke inn fila og kommentere hva\ndu har gjort n\xe5r du forlater programmet"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"definere-rutere",children:"Definere ruter(e)"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Opprett ruter (heretter kalt firewall, som ogs\xe5 brukes i GUI)"}),"\n",(0,t.jsx)(r.li,{children:"Vi anbefaler \xe5 ikke bruke snmp til \xe5 hente inn informasjon om\ninterfacer. Grunnen til det er at man sannsynligvis \xf8nsker \xe5 legge\nover filter fra ett interface i gangen. Da er det beste \xe5 gj\xf8re\ndette kontrollert en av gangen, slik at ikke man \xf8delegger gamle\nlister p\xe5 interfacer man ikke er klar til \xe5 legge over i f\xf8rste\nomgang."}),"\n",(0,t.jsx)(r.li,{children:"Opprett ett interface p\xe5 firewall. Vi starter med Loopback0 som er\nmanagement-interface. Merk dette med management og unprotected. Legg\ninn adresser p\xe5 interfacet. Det er denne adressen som blir brukt n\xe5r\nprogrammet skal legge over filterne til ruteren."}),"\n",(0,t.jsxs)(r.li,{children:["Man m\xe5 velge om policy'en for ruteren skal v\xe6re bare IPv4 eller b\xe5de\nIPv4 og IPv6. Dette gj\xf8r du ved \xe5 dobbeltklikke p\xe5 ",(0,t.jsx)(r.em,{children:"Policy"})," under\nruteren, og velger ",(0,t.jsx)(r.em,{children:"Rule set"}),"."]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"lage-filter-for-et-gitt-interface",children:"Lage filter for et gitt interface"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Lag ett nytt interface. Navngi dette til det interfacet som du skal\nlage pakkefilter for. Legg til adressene til interfacet. B\xe5de IPv4\nog IPv6."}),"\n",(0,t.jsx)(r.li,{children:"Dette interfacet er n\xe5 klart til \xe5 bruke i regler i policy'n"}),"\n",(0,t.jsx)(r.li,{children:"Dersom du har redundant ruteroppsett (f.eks VRRP), definerer du\nbegge ruterne, og lager cluster-interface. Under dette\ncluster-interfacet lager du en ny failover-group der interface fra\nbegge rutere er medlemmer. N\xe5r du n\xe5 bruker dette cluster-interfacet\ni regelsettet vil programmet s\xf8rge for at policy'n blir lagt inn p\xe5\nbegge ruterne."}),"\n",(0,t.jsx)(r.li,{children:"Opprett en ny regel i policy'n. Du kan n\xe5 dra interfacet du laget\nover i interface-kolonnen."}),"\n",(0,t.jsx)(r.li,{children:"Lag deg host, nett, tjeneste oa. objekt etterhvert som du trenger\ndem. Disse kan n\xe5 draes over i policy'n. Husk \xe5 lag b\xe5de IPv4 og\nIPv6 adresser."}),"\n",(0,t.jsx)(r.li,{children:'Programmet har ett sett med standard-bibliotek som er kjekt for\n"kjente" tjenester. Disse finner du om du velger Library Standard\nistedet for Library User.'}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"gruppere-interface",children:"Gruppere interface"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Dersom du skal lage regler som er lik for flere interface er det\nkjekt \xe5 gruppere disse i objekter. Slik kan du bruke dette objektet\ni reglene istedet. Pr\xf8v \xe5 tenk igjennom slike grupperinger p\xe5\nforh\xe5nd. Under omlegging s\xe5 s\xf8rg for \xe5 legge til nye interface inn i\ndisse objektene etterhvert som du oppretter dem i firewall builder."}),"\n",(0,t.jsx)(r.li,{children:"Vi har f.eks laget ei gruppe som inneholder alle interne VLAN. Ved \xe5\nbruke dette objektet i reglene vil alle VLAN (som er medlem i\nobjektet) f\xe5 disse samme reglene. (se eksempel nedenfor)"}),"\n",(0,t.jsx)(r.li,{children:"Det samme kan f.eks brukes for felles regler for alle vlan med\nklienter. (se eksempel nedenfor)"}),"\n",(0,t.jsx)(r.li,{children:'Regler kan grupperes slik at det blir mer oversiktlig. Vi har valgt\n\xe5 f\xf8rst gruppere regler som gjelder alle VLAN. Deretter alle klient\nVLAN. Deretter grupperer vi regler som gjelder hvert enkelt vlan.\nNest sist har vi en gruppering der vi lager midlertidige regler med\nlogging som vi bruker n\xe5r vi utarbeider filtrene. Til slutt har vi\nen gruppering der vi for hvert enkelt VLAN har en regel som s\xf8rger\nfor \xe5 "stenge enden" for ett gitt filter.'}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"eksempel-p\xe5-oppsett",children:"Eksempel p\xe5 oppsett"}),"\n",(0,t.jsx)(r.p,{children:'Her er ett eksempel der vi har opprettet to rutere (uninett-gw og\nuninett-gw2), der begge har vlan20. Vi har laget ett cluster mellom\ndisse to, og det er dette cluster-interfacet vi bruker i policyen til\nh\xf8yre. Har man kun \xe8n ruter er ikke dette n\xf8dvendig. F\xf8rst har vi\nfelles-regler som vil gjelde alle vlan-interface som blir lagt til i\n"Alle interne VLAN". S\xe5 har vi regler som vil gjelde alle\nklient-interface som blir lagt til i "Alle klient-VLAN". Deretter kommer\nspesifikke regler for Vlan 20.'}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:n(1902).A+"",width:"1561",height:"899"})}),"\n",(0,t.jsx)(r.h2,{id:"legge-over-filter-til-ruteren",children:"Legge over filter til ruteren"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"N\xe5r du er klar til \xe5 legge over reglene velger du install. Her vil\nden f\xf8rst kompilere reglene for deg."}),"\n",(0,t.jsx)(r.li,{children:"Velg inspect generated files. Slik kan du g\xe5 inn \xe5 kontrollere hva\nsom faktisk blir lagt over til ruteren i form av pakkefilter-regler."}),"\n",(0,t.jsx)(r.li,{children:"Dersom alt ser fint ut trykk next, og du vil f\xe5 opp ett\ninnloggingsvindu mot ruteren. Her kan du etterhvert f\xf8lge med mens\nruteren jobber med \xe5 legge over filtrene. Du kan ogs\xe5 velge dry run\nom du bare vil teste \xe5 legge over reglene til ruteren."}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"tips-og-triks",children:"Tips og triks"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:"Pr\xf8v ut prosessen p\xe5 ett test-vlan i f\xf8rste omgang for \xe5 gj\xf8re deg\nkjent med hvordan ting fungerer"}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsxs)(r.p,{children:["Under menyen ",(0,t.jsx)(r.code,{children:"Edit -> Preferences -> Objects -> Policy rules"}),", velg ",(0,t.jsx)(r.em,{children:"Create new policy rules with direction Outbound"}),", slik at\ndu slipper \xe5 endre den for nye regler du legger inn. Det samme kan\ndu gj\xf8re for ",(0,t.jsx)(r.em,{children:"Create new policy rules with action Accept"}),". Her er det\nogs\xe5 mulig \xe5 velge default dummy objekt for src, dst, service og\ninterface. Dette kan v\xe6re kjekt for \xe5 unng\xe5 at man glemmer \xe5 legge\ninn ett objekt p\xe5 en av disse. Ved \xe5 h\xf8yreklikke p\xe5 dummy-objektet\nf\xe5r du opp en meny der du kan velge \xe5 endre til ",(0,t.jsx)(r.code,{children:"any"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:"Det er mulig \xe5 endre bakgrunnsfarge p\xe5 reglene i regelsettet. Dette\nkan v\xe6re kjekt for \xe5 for eksempel merke regler som er midlertidig,\neller som m\xe5 sjekkes n\xe6rmere."}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:"Du kan kopiere objekt som allerede er brukt p\xe5 h\xf8yresiden i\nregelsettet ogs\xe5. Hold inn ctrl mens du peker p\xe5 ett objekt, og dra\ndit du vil kopiere til. Slik slipper du \xe5 finne igjen objekter du\nbruker ofte p\xe5 venstre-siden hele tiden."}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:"Kommenter reglene dine slik at du finner ting igjen i selve reglene."}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:"Du kan s\xf8ke p\xe5 port og ip i s\xf8kefeltet ved \xe5 skrive ip: eller port:.\nVed s\xf8king etter IP-adresse vil gi den finne alle objekter som\nomfatter denne IP-adressen, ogs\xe5 st\xf8rre nettblokker hvor IP-adressen\ner en av flere."}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:"Du kan l\xe5se av objekter som du ikke vil at noen skal endre p\xe5 ved\nett uhell. H\xf8yreklikk p\xe5 objektet og velg lock. L\xe5sen fjernes igjen\nved samme operasjon. Men da er det ett bevist valg \xe5 gj\xf8re endringer\nder iallefall. Veldig kjekt \xe5 gj\xf8re for interface f.eks som sjelden\nendres. Men f\xf8lgene ved at noen gj\xf8r feil ting der kan v\xe6re\nkritiske."}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:"Siden grupper av objekter f\xf8lger flat struktur ift. mapper har vi\nnavngitt alle grupper med suffix:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"(iface) for grupper av interface-objekter"}),"\n",(0,t.jsx)(r.li,{children:"(nett) for grupper av nettverks-objekter"}),"\n",(0,t.jsx)(r.li,{children:"(hosts) for grupper av host-objekter"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsxs)(r.p,{children:["Etter kompilering f\xe5r man opp en knapp der man kan se diff av de\ngamle og nye listene. For at dette skal virke m\xe5 det under menyen\n",(0,t.jsx)(r.code,{children:"Edit -> Preferences -> Diff"}),", v\xe6re krysset av for ",(0,t.jsx)(r.em,{children:'"Enable\nautocompiling when loading file"'}),". Vi bruker ",(0,t.jsx)(r.code,{children:"meld"})," som diff-viewer, og\nstien til den m\xe5 ogs\xe5 v\xe6re angitt der. For \xe5 unng\xe5 at ",(0,t.jsx)(r.code,{children:"meld"})," viser\nalle kommentarer som eventuelt har endret seg i koden din, s\xe5 er det\nlurt \xe5 legge inn ett filter som overser kommentarene. I menyen til\n",(0,t.jsx)(r.code,{children:"meld"}),", ",(0,t.jsx)(r.code,{children:"Edit -> Preferences -> Text Filters"}),", legg inn en ny\nregel som som ser slik ut ",(0,t.jsx)(r.code,{children:"^! Rule.\\*"})," (Uten semikolon)."]}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsxs)(r.p,{children:["For \xe5 sikre at vi f\xe5r ",(0,t.jsx)(r.em,{children:"write mem"})," + ",(0,t.jsx)(r.em,{children:"write net"})," etter at filter er lagt\nover editerer vi for hver ruter ",(0,t.jsx)(r.em,{children:'"Firewall Settings\u2026"'})," ",(0,t.jsx)(r.em,{children:"Prolog/Epilog"}),"\nog legger til f\xf8lgende i epilogen:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"exit\nwrite memory\ntclsh\nexec copy running-config tftp://trane.uninett.no/uninett-gw-confg\nexit\n"})}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:"Husk \xe5 fjerne de gamle filtrene fra ruteren, og evt. fra tftpboot p\xe5\nverkt\xf8ykassen i etterkant. Da slipper du forvirring p\xe5 hvilken liste\nsom faktisk er i drift."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"kontaktpersoner",children:"Kontaktpersoner"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.a,{href:"mailto:rune.sydskjor@sikt.no",children:"rune.sydskjor@sikt.no"})}),"\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.a,{href:"mailto:morten.knutsen@sikt.no",children:"morten.knutsen@sikt.no"})}),"\n"]})]})}function m(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(g,{...e})}):g(e)}},1902:(e,r,n)=>{n.d(r,{A:()=>t});const t=n.p+"assets/images/fw_eksempel-5ed716fd88f9a2d29ec6a5c573ba2fbe.png"},8453:(e,r,n)=>{n.d(r,{R:()=>s,x:()=>d});var t=n(6540);const i={},l=t.createContext(i);function s(e){const r=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(l.Provider,{value:r},e.children)}}}]);