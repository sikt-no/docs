"use strict";(self.webpackChunkdocs_sikt_no=self.webpackChunkdocs_sikt_no||[]).push([[4727],{5102:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"iam/integrasjoner/Servicenow","title":"ServiceNow","description":"Portalldaptoservicenow","source":"@site/docs/iam/integrasjoner/Servicenow.md","sourceDirName":"iam/integrasjoner","slug":"/iam/integrasjoner/Servicenow","permalink":"/docs/iam/integrasjoner/Servicenow","draft":false,"unlisted":false,"editUrl":"https://github.com/sikt-no/docs/tree/master/docs/iam/integrasjoner/Servicenow.md","tags":[],"version":"current","lastUpdatedAt":1761829665000,"frontMatter":{"title":"ServiceNow"},"sidebar":"iam","previous":{"title":"Salto","permalink":"/docs/iam/integrasjoner/Salto"},"next":{"title":"TopDesk","permalink":"/docs/iam/integrasjoner/TopDesk"}}');var r=s(4848),o=s(8453);const l={title:"ServiceNow"},t=void 0,c={},d=[{value:"Portalldaptoservicenow",id:"portalldaptoservicenow",level:2},{value:"Description",id:"description",level:4},{value:"Input Parameters",id:"input-parameters",level:4},{value:"Local Variables",id:"local-variables",level:4},{value:"Workflow",id:"workflow",level:4},{value:"External Systems and Communications",id:"external-systems-and-communications",level:4},{value:"Response Codes/Outputs",id:"response-codesoutputs",level:4},{value:"Summary",id:"summary",level:4}];function a(e){const n={code:"code",em:"em",h2:"h2",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"portalldaptoservicenow",children:"Portalldaptoservicenow"}),"\n",(0,r.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,r.jsx)(n.p,{children:"This script iterates through changed employee records to provision or deprovision them to ServiceNow. It handles creating, updating, and disabling user accounts based on their entitlements and affiliations."}),"\n",(0,r.jsx)(n.h4,{id:"input-parameters",children:"Input Parameters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"resetCookie"}),": Boolean (optional) - Resets the cookie file if true."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"logOnly"}),": Boolean (optional) - If true, only logs actions without making changes."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"key_field"}),": String (optional) - Field to filter records."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"key_value"}),": String (optional) - Value to filter records."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"verbose"}),": Boolean (optional) - Enables verbose logging."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"local-variables",children:"Local Variables"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"total"}),", ",(0,r.jsx)(n.code,{children:"totalSkipped"}),", ",(0,r.jsx)(n.code,{children:"totalAdd"}),", ",(0,r.jsx)(n.code,{children:"totalAddFail"}),", ",(0,r.jsx)(n.code,{children:"totalUpdate"}),", ",(0,r.jsx)(n.code,{children:"totalUpdateFail"}),", ",(0,r.jsx)(n.code,{children:"totalDisable"}),", ",(0,r.jsx)(n.code,{children:"totalDisableFail"}),": Counters for tracking operations."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"processedAccounts"}),": Dictionary to track processed records."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ldapConn"}),", ",(0,r.jsx)(n.code,{children:"sessionMV"}),": Connection objects for LDAP and MetaVault."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"headers"}),": Record to store HTTP headers."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"workflow",children:"Workflow"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Initialize Variables"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Set initial values for counters and other variables."}),"\n",(0,r.jsx)(n.li,{children:"Check and reset the cookie file if necessary."}),"\n",(0,r.jsx)(n.li,{children:"Establish connections to Portal LDAP and MetaVault."}),"\n",(0,r.jsx)(n.li,{children:"Set HTTP headers."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Collect Data"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Query LDAP for changed records based on ",(0,r.jsx)(n.code,{children:"key_field"})," and ",(0,r.jsx)(n.code,{children:"key_value"})," or iterate through change logs."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Iterate Through Records"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Skip deleted and already processed records."}),"\n",(0,r.jsx)(n.li,{children:"Fetch full record from LDAP."}),"\n",(0,r.jsx)(n.li,{children:"Calculate primary affiliation and determine provisioning status."}),"\n",(0,r.jsx)(n.li,{children:"Fetch user from ServiceNow based on various identifiers."}),"\n",(0,r.jsx)(n.li,{children:"Create or update ServiceNow user object based on LDAP record."}),"\n",(0,r.jsx)(n.li,{children:"Perform necessary HTTP operations to create or update the user in ServiceNow."}),"\n",(0,r.jsx)(n.li,{children:"Log events and update entitlements."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Close Connections"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Close all established connections."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Log Results"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Log summaries of operations, including successes and failures."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"external-systems-and-communications",children:"External Systems and Communications"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ServiceNow"}),": Target system where user accounts are managed."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Portal LDAP"}),": Source system for user data."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"MetaVault"}),": Used to query user roles and affiliations."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"response-codesoutputs",children:"Response Codes/Outputs"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error Codes"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"LDAP_CONNECTION_FAILED"}),": Failure in connecting to LDAP."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MV_CONNECTION_FAILED"}),": MetaVault connection error."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"USER_NOT_FOUND"}),": User not found in ServiceNow."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"SERVICE_NOW_USER_CREATE_FAILED"}),": Failed to create a user in ServiceNow."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"SERVICE_NOW_USER_UPDATE_FAILED"}),": Failed to update a user in ServiceNow."]}),"\n",(0,r.jsx)(n.li,{children:"Other codes as encountered during execution."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"This script iterates through changed employee records to provision or deprovision them to ServiceNow. It handles creating, updating, and disabling user accounts based on their entitlements and affiliations, ensuring accurate and up-to-date user management in ServiceNow."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:"Written by AI (2025-10-30)"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>t});var i=s(6540);const r={},o=i.createContext(r);function l(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);