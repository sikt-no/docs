"use strict";(self.webpackChunkdocs_sikt_no=self.webpackChunkdocs_sikt_no||[]).push([[669],{3905:(e,t,r)=>{r.d(t,{Zo:()=>k,kt:()=>g});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),p=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},k=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,k=l(e,["components","mdxType","originalType","parentName"]),m=p(r),g=a,u=m["".concat(s,".").concat(g)]||m[g]||d[g]||i;return r?n.createElement(u,o(o({ref:t},k),{},{components:r})):n.createElement(u,o({ref:t},k))}));function g(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var p=2;p<i;p++)o[p]=r[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},2259:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var n=r(7462),a=(r(7294),r(3905));const i={description:"Hjelp til oppsett av Digdir sine REST API'er  mot Folkeregisteret og KRR (Kontakt og reservasjonsregisteret).",title:"Digdir Folkeregisteret og KRR"},o="Digdir API'er mot Folkeregisteret og KRR",l={unversionedId:"datadeling/teknisk-plattform/api/digdir",id:"datadeling/teknisk-plattform/api/digdir",title:"Digdir Folkeregisteret og KRR",description:"Hjelp til oppsett av Digdir sine REST API'er  mot Folkeregisteret og KRR (Kontakt og reservasjonsregisteret).",source:"@site/docs/datadeling/teknisk-plattform/api/digdir.md",sourceDirName:"datadeling/teknisk-plattform/api",slug:"/datadeling/teknisk-plattform/api/digdir",permalink:"/docs/datadeling/teknisk-plattform/api/digdir",draft:!1,editUrl:"https://github.com/sikt-no/docs/tree/master/docs/datadeling/teknisk-plattform/api/digdir.md",tags:[],version:"current",lastUpdatedAt:1699252628,formattedLastUpdatedAt:"Nov 6, 2023",frontMatter:{description:"Hjelp til oppsett av Digdir sine REST API'er  mot Folkeregisteret og KRR (Kontakt og reservasjonsregisteret).",title:"Digdir Folkeregisteret og KRR"},sidebar:"datadeling",previous:{title:"DF\xd8 SAP",permalink:"/docs/datadeling/teknisk-plattform/api/dfo-sap"},next:{title:"Felles Studentsystem - FS-API",permalink:"/docs/datadeling/teknisk-plattform/api/fs"}},s={},p=[{value:"Om API-ene",id:"om-api-ene",level:2},{value:"Standardoppsett",id:"standardoppsett",level:2},{value:"Hvordan sette opp API-ene",id:"hvordan-sette-opp-api-ene",level:2},{value:"Oppsett detaljer",id:"oppsett-detaljer",level:3},{value:"Folkeregisteret API",id:"folkeregisteret-api",level:4},{value:"KRR",id:"krr",level:4},{value:"Hvordan verifisere at API-et fungerer:",id:"hvordan-verifisere-at-api-et-fungerer",level:3}],k={toc:p};function d(e){let{components:t,...i}=e;return(0,a.kt)("wrapper",(0,n.Z)({},k,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"digdir-apier-mot-folkeregisteret-og-krr"},"Digdir API'er mot Folkeregisteret og KRR"),(0,a.kt)("p",null,"Hjelp til oppsett av Digdir sine REST API'er  mot Folkeregisteret og KRR (Kontakt og reservasjonsregisteret)."),(0,a.kt)("h2",{id:"om-api-ene"},"Om API-ene"),(0,a.kt)("p",null,"Folkeregisteret API gir tilgang til \xe5 hente ut opplysninger om persondata fra Folkeregisteret. Se ",(0,a.kt)("a",{parentName:"p",href:"https://skatteetaten.github.io/folkeregisteret-api-dokumentasjon/om-tjenestene/"},"Folkeregisteret API-portal")," for mer informasjon."),(0,a.kt)("p",null,"KRR API gir tilgang til \xe5 hente ut kontakt- og reservasjonsopplysninger fra kontakt- og reservasjonsregisteret. Se ",(0,a.kt)("a",{parentName:"p",href:"https://docs.digdir.no/docs/Kontaktregisteret/oppslagstjenesten_rest"},"KRR API-portal")," for mer informasjon."),(0,a.kt)("p",null,"API'ene krever autentisering via ",(0,a.kt)("a",{parentName:"p",href:"https://samarbeid.digdir.no/maskinporten/maskinporten/25"},"Maskinporten"),", s\xe5 institusjonen m\xe5 registrere seg der f\xf8r integrasjonen kan opprettes. Maskinporten bruker virksomhetssertifikater eller selvsignerte n\xf8kler for autentisering."),(0,a.kt)("h2",{id:"standardoppsett"},"Standardoppsett"),(0,a.kt)("p",null,"Folkeregisteret API og KRR API er statlige fellestjenester, og m\xe5/b\xf8r derfor settes opp likt hos alle institusjoner. Du kan sette dette opp ved \xe5 laste inn fil med standardoppsett:"),(0,a.kt)("p",null,(0,a.kt)("a",{target:"_blank",href:r(2561).Z},"digdir-freg-api-template.json")),(0,a.kt)("p",null,(0,a.kt)("a",{target:"_blank",href:r(1507).Z},"digdir-krr-api-template.json")),(0,a.kt)("p",null,"Standardoppsettene er satt opp med et utg\xe5ende kall mot Maskinporten for \xe5 f\xe5 utstedt et token for autentisering. Tjenesten som utsteder token kan enten settes opp i Gravitee (",(0,a.kt)("a",{parentName:"p",href:"/docs/datadeling/teknisk-plattform/api/maskinporten"},"se bruksanvisning her"),") eller hos den enkelte institusjon. Oppsettfilene er i utgangspunktet satt opp til \xe5 g\xe5 mot en slik intern tjeneste."),(0,a.kt)("h2",{id:"hvordan-sette-opp-api-ene"},"Hvordan sette opp API-ene"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Registrer din institusjon hos Maskinporten, ",(0,a.kt)("a",{parentName:"li",href:"https://samarbeid.digdir.no/maskinporten/konsument/119"},"se planleggingsaktiviteten her"),". Registrer deretter en integrasjon i maskinporten, se veiledning her(",(0,a.kt)("a",{parentName:"li",href:"https://docs.digdir.no/docs/Maskinporten/maskinporten_sjolvbetjening_web.html"},"https://docs.digdir.no/docs/Maskinporten/maskinporten_sjolvbetjening_web.html"),") Sluttresultatet er at du har en integrasjon hvor du kan autentisere vha. virksomhetssertifikat eller selvsignerte n\xf8kler (og som bare brukes mot denne integrasjonen). Integrasjonen m\xe5 ha blitt tildelt de n\xf8dvendige scopes (se ",(0,a.kt)("a",{parentName:"li",href:"#oppsett-detaljer"},"Oppsett detaljer"),") og du m\xe5 ha issuer-ID tilgjengelig"),(0,a.kt)("li",{parentName:"ol"},"Opprett tokentjeneste om du ikke har gjort det tidligere og gi APIet tilgang.",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Om du vil lage en i gravitee ",(0,a.kt)("a",{parentName:"li",href:"/docs/datadeling/teknisk-plattform/api/maskinporten"},"se veiledning her")," Gi deretter APIet tilgang ved \xe5 opprette en applikasjon for dette og s\xf8k om tilgang til maskinporten-APIet. N\xe5r tilgangen er gitt f\xe5r du en API-n\xf8kkel som vi bruker i neste steg"))),(0,a.kt)("li",{parentName:"ol"},"Last ned standardoppsettet over, og opprett tjenesten i API manager. Se ",(0,a.kt)("a",{parentName:"li",href:"/docs/datadeling/veiledere/api-manager/importer-api"},"veileder for \xe5 registrere en tjeneste i API manager via fil"),".",(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},"Inne p\xe5 API'et du nettop importerte, g\xe5 til ",(0,a.kt)("em",{parentName:"li"},"Design")),(0,a.kt)("li",{parentName:"ol"},"Klikk p\xe5 ",(0,a.kt)("inlineCode",{parentName:"li"},"[ALL] /**")," under ",(0,a.kt)("em",{parentName:"li"},"API Flows")," og s\xe5 p\xe5 ",(0,a.kt)("em",{parentName:"li"},"HTTP Callout")),(0,a.kt)("li",{parentName:"ol"},"Endre URL til den interne tokentjenesten"),(0,a.kt)("li",{parentName:"ol"},"G\xe5 videre til ",(0,a.kt)("em",{parentName:"li"},"Properties")," (oppe til h\xf8yre)"),(0,a.kt)("li",{parentName:"ol"},"Legg inn property med ",(0,a.kt)("em",{parentName:"li"},"key")," ",(0,a.kt)("inlineCode",{parentName:"li"},"maskinporten_api_key")," og value er API-n\xf8kkel du ble tildelt i punkt 2 over"),(0,a.kt)("li",{parentName:"ol"},"Legg inn property med ",(0,a.kt)("em",{parentName:"li"},"key")," ",(0,a.kt)("inlineCode",{parentName:"li"},"maskinporten_api_iss")," og value er ",(0,a.kt)("em",{parentName:"li"},"Integrasjons-ID")," til integrasjonen du satte opp i Maskinporten i punkt 1 overmaskinporten-integrasjonen"))),(0,a.kt)("li",{parentName:"ol"},"Andre verdier du eventuelt kan endre:",(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},"Hvis du skal sette opp mot prod: g\xe5 inn p\xe5 ",(0,a.kt)("em",{parentName:"li"},"Proxy")," -",">"," ",(0,a.kt)("em",{parentName:"li"},"Endpoints")," under ",(0,a.kt)("em",{parentName:"li"},"Backend services")," og endre URL til produksjonsmilj\xf8et (se ",(0,a.kt)("a",{parentName:"li",href:"#oppsett-detaljer"},"Oppsett detaljer"),")"),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("em",{parentName:"li"},"Gateway context path")," under ",(0,a.kt)("em",{parentName:"li"},(0,a.kt)("strong",{parentName:"em"},"Entry"),"points")),(0,a.kt)("li",{parentName:"ol"},"Navn og beskrivelse")))),(0,a.kt)("p",null,"API-et er n\xe5 satt opp."),(0,a.kt)("h3",{id:"oppsett-detaljer"},"Oppsett detaljer"),(0,a.kt)("h4",{id:"folkeregisteret-api"},"Folkeregisteret API"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Endpoint:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Prod: ",(0,a.kt)("a",{parentName:"li",href:"https://folkeregisteret.api.skatteetaten.no/"},"https://folkeregisteret.api.skatteetaten.no/")),(0,a.kt)("li",{parentName:"ul"},"Test: ",(0,a.kt)("a",{parentName:"li",href:"https://folkeregisteret-api-konsument.sits.no/"},"https://folkeregisteret-api-konsument.sits.no/")))),(0,a.kt)("li",{parentName:"ul"},"Scope: ",(0,a.kt)("inlineCode",{parentName:"li"},"folkeregister:deling/offentligutenhjemmel")," og/eller ",(0,a.kt)("inlineCode",{parentName:"li"},"folkeregister:deling/offentligmedhjemmel"))),(0,a.kt)("h4",{id:"krr"},"KRR"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Enpoint",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Prod: ",(0,a.kt)("a",{parentName:"li",href:"https://kontaktregisteret.no/rest/v1/personer"},"https://kontaktregisteret.no/rest/v1/personer")),(0,a.kt)("li",{parentName:"ul"},"Test: ",(0,a.kt)("a",{parentName:"li",href:"https://test.kontaktregisteret.no/rest/v1/personer"},"https://test.kontaktregisteret.no/rest/v1/personer")))),(0,a.kt)("li",{parentName:"ul"},"Scope: ",(0,a.kt)("inlineCode",{parentName:"li"},"krr:global/kontaktinformasjon.read"))),(0,a.kt)("h3",{id:"hvordan-verifisere-at-api-et-fungerer"},"Hvordan verifisere at API-et fungerer:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Opprett din egen klient (applikasjon) i API manager, om du ikke har dette allerede.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Be om tilgang til API-et.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Godkjenn tilgangen til API-et. Du har n\xe5 f\xe5tt en egen API-n\xf8kkel for din klient.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Bruk klientens API-n\xf8kkel, og sjekk at du f\xe5r hentet ut data:"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Test av Folkeregisteret API med curl (husk \xe5 endre det som st\xe5r i uthevet tekst):")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},'curl --include -H "X-Gravitee-Api-Key: **API-n\xf8kkel**" https://gw-**INSTANS**.intark.uh-it.no/test/digidir/freg/personer/18906299204\n')),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Test av KRR API (husk \xe5 endre det som st\xe5r i uthevet tekst):")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},'curl --include -H "X-Gravitee-Api-Key: **API-n\xf8kkel**" -H "Content-Type: application/json" -d \'{"personidentifikatorer":["23079422568"]}\' -X POST https://gw-**INSTANS**.intark.uh-it.no/test/digdir/krr/personer\n')),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},'Hvis alt er ok kan du forvente \xe5 f\xe5 tilbake noe som starter med "HTTP 200" og JSON-data.')))))}d.isMDXComponent=!0},2561:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/files/digdir-freg-api-template-795bf9ece4d7f60aef5889c56d41a9a5.json"},1507:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/files/digdir-krr-api-template-1677a5d5154a61f14c727d0e13b731a1.json"}}]);