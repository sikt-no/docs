"use strict";(self.webpackChunkdocs_sikt_no=self.webpackChunkdocs_sikt_no||[]).push([[7176],{8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var r=s(6540);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}},8659:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>c,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"nettadministrasjon/xymon","title":"Xymon-integrasjon p\xe5 verkt\xf8ykasser","description":"Innledning","source":"@site/docs/nettadministrasjon/xymon.md","sourceDirName":"nettadministrasjon","slug":"/nettadministrasjon/xymon","permalink":"/docs/nettadministrasjon/xymon","draft":false,"unlisted":false,"editUrl":"https://github.com/sikt-no/docs/tree/master/docs/nettadministrasjon/xymon.md","tags":[],"version":"current","lastUpdatedAt":1629936000000,"frontMatter":{"title":"Xymon-integrasjon p\xe5 verkt\xf8ykasser","last_update":{"date":"2021-08-26T00:00:00.000Z","author":"morten.brekkevold@sikt.no"}},"sidebar":"nettadministrasjon","previous":{"title":"Brukerdokumentasjon Verkt\xf8ykasser","permalink":"/docs/nettadministrasjon/brukerdok"},"next":{"title":"Firewall builder","permalink":"/docs/nettadministrasjon/fwbuilder"}}');var t=s(4848),i=s(8453);const o={title:"Xymon-integrasjon p\xe5 verkt\xf8ykasser",last_update:{date:new Date("2021-08-26T00:00:00.000Z"),author:"morten.brekkevold@sikt.no"}},l=void 0,a={},d=[{value:"Innledning",id:"innledning",level:2},{value:"Tjenester",id:"tjenester",level:2},{value:"Brukerdokumentasjon",id:"brukerdokumentasjon",level:2},{value:"Maskiner som overv\xe5kes med Xymon",id:"maskiner-som-overv\xe5kes-med-xymon",level:3},{value:"Overv\xe5king av grupper",id:"overv\xe5king-av-grupper",level:3},{value:"Overv\xe5king av maskiner",id:"overv\xe5king-av-maskiner",level:3},{value:"Installere xymon-client p\xe5 klienten",id:"installere-xymon-client-p\xe5-klienten",level:3},{value:"Varsling",id:"varsling",level:3},{value:"Kontaktadresser",id:"kontaktadresser",level:2}];function m(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"innledning",children:"Innledning"}),"\n",(0,t.jsxs)(n.p,{children:["Xymon (tidl. ",(0,t.jsx)(n.em,{children:"Hobbit"}),") er et tjenesteoverv\xe5kningsverkt\xf8y som kj\xf8rer p\xe5\nverkt\xf8ykassen, og som er integrert med NAV-installasjonen der. Det er\nkun utstyr som legges inn i kategorien ",(0,t.jsx)(n.code,{children:"SRV"})," i NAV som blir automatisk\noverv\xe5ket av Xymon. For mer informasjon om Xymon, se ",(0,t.jsx)(n.a,{href:"https://xymon.sourceforge.io/",children:"Xymons\nhjemmesider."})]}),"\n",(0,t.jsxs)(n.p,{children:["Da Hobbit ble omd\xf8pt til Xymon, var det en del begrepsbruk og\nkonfigurasjonsfiler som ogs\xe5 endret seg. Dersom du er vant med de gamle\nfilene og begrepene, kan du lese\n",(0,t.jsx)(n.a,{href:"https://xymon.com/help/upgrade-to-430.txt",children:"Xymons"}),"\noppgraderingsnotater."]}),"\n",(0,t.jsx)(n.h2,{id:"tjenester",children:"Tjenester"}),"\n",(0,t.jsx)(n.p,{children:"Det er Xymon og Apache som m\xe5 kj\xf8re for at tjenesten skal virke."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"xymon"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Daemon:"}),"\n",(0,t.jsxs)(n.li,{children:["Start/stop: ",(0,t.jsx)(n.code,{children:"/etc/init.d/xymon {start/stop/restart}"})]}),"\n",(0,t.jsxs)(n.li,{children:["Configfiler: ",(0,t.jsx)(n.code,{children:"/etc/xymon/"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"apache2"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Daemon: ",(0,t.jsx)(n.code,{children:"/usr/sbin/apache2"})]}),"\n",(0,t.jsxs)(n.li,{children:["Start/stopp: ",(0,t.jsx)(n.code,{children:"/etc/init.d/apache2 {start/stop/restart/reload}"})]}),"\n",(0,t.jsxs)(n.li,{children:["config: ",(0,t.jsx)(n.code,{children:"/etc/apache2/sites-enabled/25-nav-secure.conf"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"brukerdokumentasjon",children:"Brukerdokumentasjon"}),"\n",(0,t.jsx)(n.h3,{id:"maskiner-som-overv\xe5kes-med-xymon",children:"Maskiner som overv\xe5kes med Xymon"}),"\n",(0,t.jsxs)(n.p,{children:["Hvert kvarter kj\xf8rer et script p\xe5 verkt\xf8ykassen som konfigurerer Xymon\ntil \xe5 overv\xe5ke alle maskiner fra ",(0,t.jsx)(n.code,{children:"SRV"}),"-kategorien i NAV. Dette gj\xf8r at\ndet er bare ett sted for \xe5 vedlikeholde listen over servere som skal\noverv\xe5kes i NAV og Xymon. N\xe5r en maskin registreres i NAV, kan den\nlegges inn i opptil flere grupper (",(0,t.jsx)(n.em,{children:"device groups"}),"). Disse gruppene blir\nogs\xe5 brukt som grupper i Xymon."]}),"\n",(0,t.jsx)(n.h3,{id:"overv\xe5king-av-grupper",children:"Overv\xe5king av grupper"}),"\n",(0,t.jsxs)(n.p,{children:["Man kan sette opp overv\xe5king av bestemte services for hver enkelt\ngruppe. Man kan f.eks overv\xe5ke SMTP for alle servere som ligger i\nmail-gruppa. Dette gj\xf8res ved \xe5 logge p\xe5 verkt\xf8ykassen med ssh. Man\nredigerer filen ",(0,t.jsx)(n.code,{children:"/etc/nav/navsrv2hobbit.conf"}),". Her er et eksempel p\xe5\nhvordan man kan gj\xf8re det:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ini",children:"[ALL]\nservices = ssh\n\n[MAIL]\nservices = smtp\n"})}),"\n",(0,t.jsx)(n.p,{children:"Her ser vi at ssh overv\xe5kes for samtlige maskiner, mens SMTP overv\xe5kes\nbare for den gruppen av maskiner som befinner seg i gruppen MAIL i NAV.\nSSH ligger som standardoverv\xe5king for samtlige maskiner."}),"\n",(0,t.jsx)(n.h3,{id:"overv\xe5king-av-maskiner",children:"Overv\xe5king av maskiner"}),"\n",(0,t.jsxs)(n.p,{children:["Man kan sette opp bestemte overv\xe5kinger for hver enkelt maskin, ved \xe5\nlegge til sine egne konfigurasjonsfiler p\xe5 verkt\xf8ykassen, under\n",(0,t.jsx)(n.code,{children:"/etc/xymon/analysis.d/"}),". Verkt\xf8ykassen overv\xe5ker seg selv med Xymon p\xe5\ndenne m\xe5ten, og konfigurasjonen som brukes her kan ses i filen ",(0,t.jsx)(n.code,{children:"vk.cfg"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Et eksempel p\xe5 en slik konfigurasjonsfil kan se slik ut:"}),"\n",(0,t.jsx)(n.p,{children:"HOST=testserver.uninett.no\nPROC        cfenvd 1 1 yellow\nPROC        cfservd 1 1 red\nPROC        munin-node 1 -1 red\nPROC        sshd\nPROC        ntpd 1 1 yellow\nDISK        /home 95 98\nDISK        /var/log 95 98"}),"\n",(0,t.jsxs)(n.p,{children:["Her ser vi hvilke bestemte prosesser som er satt opp til overv\xe5king med\nat det st\xe5r ",(0,t.jsx)(n.code,{children:"PROC"})," foran prosessnavnet. Bak hver prosess kan man ha et\ntall som angir hvor mange prosesser som kan kj\xf8res. P\xe5 prosessen\n",(0,t.jsx)(n.code,{children:"cfenvd"})," st\xe5r det f\xf8rst tallet ",(0,t.jsx)(n.code,{children:"1"}),", som betyr at det minimum m\xe5 v\xe6re \xe9n\nprosess (",(0,t.jsx)(n.em,{children:"mincount"}),") ved det navnet og bak tallet st\xe5r det ",(0,t.jsx)(n.code,{children:"1"}),"\n(",(0,t.jsx)(n.em,{children:"maxcount"}),"). Dette betyr at det kan kun v\xe6re \xe9n (og bare \xe9n) prosess av\n",(0,t.jsx)(n.code,{children:"cfenvd"}),". Hvis ikke dette er oppfylt vil den blir markert som gul i\nXymon, i motsetning til ",(0,t.jsx)(n.code,{children:"cfservd"}),", der det vil bli markert som r\xf8dt. Man\nkan p\xe5 denne m\xe5ten angi hvor mange prosesser som skal kj\xf8re. I tillegg\nkan man bruke verdien ",(0,t.jsx)(n.code,{children:"-1"}),", som betyr at det kan v\xe6re uendelig mange\nprosesser som kj\xf8res."]}),"\n",(0,t.jsxs)(n.p,{children:["I tillegg kan man sette opp overv\xe5king av disk-partisjoner. Hvis ",(0,t.jsx)(n.code,{children:"/home"}),"\n(som i eks. over) fylles opp til 95% vil den bli gul, mens kommer den p\xe5\n98% vil den flagges r\xf8d i Xymon."]}),"\n",(0,t.jsxs)(n.p,{children:["Som standard p\xe5 samtlige servere st\xe5r det f\xf8lgende regler\n(",(0,t.jsx)(n.code,{children:"/etc/xymon/analysis.cfg"}),"):"]}),"\n",(0,t.jsx)(n.p,{children:"DEFAULT\nUP      1h\nLOAD    5.0 10.0\nDISK    * 90 95\nMEMPHYS 100 101\nMEMSWAP 50 80\nMEMACT  90 97"}),"\n",(0,t.jsx)(n.h3,{id:"installere-xymon-client-p\xe5-klienten",children:"Installere xymon-client p\xe5 klienten"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Programmet ",(0,t.jsx)(n.strong,{children:"xymon-client"})," m\xe5 installeres p\xe5 klienten som skal\noverv\xe5kes."]}),"\n",(0,t.jsxs)(n.li,{children:["IP-adressen til verkt\xf8ykassen m\xe5 settes i\n",(0,t.jsx)(n.code,{children:"/etc/default/xymon-client"}),", slik at xymon-client vet hvor den skal\nrapportere."]}),"\n",(0,t.jsxs)(n.li,{children:["For Windows-maskiner som skal overv\xe5kes m\xe5\n",(0,t.jsx)(n.em,{children:(0,t.jsx)(n.a,{href:"http://bbwin.sourceforge.net/",children:"BBWin"})})," installeres p\xe5 klienten."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"varsling",children:"Varsling"}),"\n",(0,t.jsxs)(n.p,{children:["Varsling fra Xymon er integrert med NAVs hendelses- og alarmsystem, og\nstyres gjennom din personlige alarmprofil i NAV. Her viser vi til\n",(0,t.jsx)(n.a,{href:"https://nav.readthedocs.io/",title:"G\xe5 til NAVs\ndokumentasjon",children:"dokumentasjon om NAV"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"kontaktadresser",children:"Kontaktadresser"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"mailto:kontakt@sikt.no",children:"kontakt@sikt.no"})}),"\n"]})]})}function c(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(m,{...e})}):m(e)}}}]);