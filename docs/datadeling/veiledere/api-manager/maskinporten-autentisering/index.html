<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-datadeling/veiledere/api-manager/maskinporten-autentisering" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Konfigurere autentisering via maskinporten | Sikt teknisk dokumentasjon</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.sikt.no/docs/datadeling/veiledere/api-manager/maskinporten-autentisering"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Konfigurere autentisering via maskinporten | Sikt teknisk dokumentasjon"><meta data-rh="true" name="description" content="[Under utvikling: Anbefalingen vil endre seg, etter erfaringer med BOTT:ØL i 2021]


Hvordan du kan sette opp autentisering av ditt API via Maskinporten, når du trenger å snakke med API utenfor din organisasjon."><meta data-rh="true" property="og:description" content="[Under utvikling: Anbefalingen vil endre seg, etter erfaringer med BOTT:ØL i 2021]


Hvordan du kan sette opp autentisering av ditt API via Maskinporten, når du trenger å snakke med API utenfor din organisasjon."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.sikt.no/docs/datadeling/veiledere/api-manager/maskinporten-autentisering"><link data-rh="true" rel="alternate" href="https://docs.sikt.no/docs/datadeling/veiledere/api-manager/maskinporten-autentisering" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.sikt.no/docs/datadeling/veiledere/api-manager/maskinporten-autentisering" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Veiledere i IntArk","item":"https://docs.sikt.no/docs/datadeling/veiledere/"},{"@type":"ListItem","position":2,"name":"Konfigurere autentisering via maskinporten ","item":"https://docs.sikt.no/docs/datadeling/veiledere/api-manager/maskinporten-autentisering"}]}</script><link rel="stylesheet" href="/assets/css/styles.fe75318c.css">
<script src="/assets/js/runtime~main.eeb2daed.js" defer="defer"></script>
<script src="/assets/js/main.a1db3a83.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/sikt_logo.svg"><link rel="preload" as="image" href="/img/sikt_logo_white.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/sikt_logo.svg" alt="Sikt logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/sikt_logo_white.svg" alt="Sikt logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">teknisk dokumentasjon</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/datadeling/"><span title="Datadeling" class="categoryLinkLabel_W154">Datadeling</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/"><span title="Fellestjeneste for Datadeling (IntArk)" class="linkLabel_WmDU">Fellestjeneste for Datadeling (IntArk)</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/datadeling/om/"><span title="Hva er Fellestjenesten for Datadeling (IntArk)?" class="categoryLinkLabel_W154">Hva er Fellestjenesten for Datadeling (IntArk)?</span></a><button aria-label="Expand sidebar category &#x27;Hva er Fellestjenesten for Datadeling (IntArk)?&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/datadeling/teknisk-plattform/"><span title="IntArk sin tekniske plattform" class="categoryLinkLabel_W154">IntArk sin tekniske plattform</span></a><button aria-label="Expand sidebar category &#x27;IntArk sin tekniske plattform&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/datadeling/begreper/"><span title="Begreper i IntArk" class="categoryLinkLabel_W154">Begreper i IntArk</span></a><button aria-label="Expand sidebar category &#x27;Begreper i IntArk&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/datadeling/erfaringer/"><span title="Erfaringer fra bruk av IntArk" class="categoryLinkLabel_W154">Erfaringer fra bruk av IntArk</span></a><button aria-label="Expand sidebar category &#x27;Erfaringer fra bruk av IntArk&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/faq"><span title="Spørsmål og svar" class="linkLabel_WmDU">Spørsmål og svar</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/datadeling/god-praksis/"><span title="God praksis i fellestjenesten for Datadeling" class="categoryLinkLabel_W154">God praksis i fellestjenesten for Datadeling</span></a><button aria-label="Expand sidebar category &#x27;God praksis i fellestjenesten for Datadeling&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/kode"><span title="Kode som bruker IntArk" class="linkLabel_WmDU">Kode som bruker IntArk</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/datadeling/malgrupper/anskaffer/"><span title="malgrupper" class="categoryLinkLabel_W154">malgrupper</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/prinsippene"><span title="Integrasjonsprinsippene for IntArk" class="linkLabel_WmDU">Integrasjonsprinsippene for IntArk</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/styringsregler"><span title="Styringsreglene til IntArk" class="linkLabel_WmDU">Styringsreglene til IntArk</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/unntak"><span title="Unntakshåndtering" class="linkLabel_WmDU">Unntakshåndtering</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/datadeling/veiledere/"><span title="Veiledere i IntArk" class="categoryLinkLabel_W154">Veiledere i IntArk</span></a><button aria-label="Collapse sidebar category &#x27;Veiledere i IntArk&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/innforing"><span title="Kom i gang" class="linkLabel_WmDU">Kom i gang</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/datadeling/veiledere/annet/anskaffelse/"><span title="annet" class="categoryLinkLabel_W154">annet</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/datadeling/veiledere/api-manager/api-manager-be-om-tilgang"><span title="api-manager" class="categoryLinkLabel_W154">api-manager</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/api-manager-be-om-tilgang"><span title="Få tilgang til et API" class="linkLabel_WmDU">Få tilgang til et API</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/api-manager-registrere-enkelt-api"><span title="Registrere et enkelt API" class="linkLabel_WmDU">Registrere et enkelt API</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/api-tilganger"><span title="Forvaltning av tilganger til API" class="linkLabel_WmDU">Forvaltning av tilganger til API</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/backend"><span title="Konfigurere backend" class="linkLabel_WmDU">Konfigurere backend</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/caching-gravitee"><span title="Caching i gravitee" class="linkLabel_WmDU">Caching i gravitee</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/filtrere-innhold-json"><span title="Filtrere bort innhold i responsen fra et API" class="linkLabel_WmDU">Filtrere bort innhold i responsen fra et API</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/godkjenne-tilgang-til-api"><span title="Godkjenne tilgang til API" class="linkLabel_WmDU">Godkjenne tilgang til API</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/importer-api"><span title="Importer API-oppsett fra fil" class="linkLabel_WmDU">Importer API-oppsett fra fil</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/jwt-mot-backend"><span title="Backend-autentisering med JWTs" class="linkLabel_WmDU">Backend-autentisering med JWTs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/legge-pa-enkel-policy"><span title="Legge på en enkel policy (IP filter)" class="linkLabel_WmDU">Legge på en enkel policy (IP filter)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/datadeling/veiledere/api-manager/maskinporten-autentisering"><span title="Konfigurere autentisering via maskinporten " class="linkLabel_WmDU">Konfigurere autentisering via maskinporten </span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/opprette-plan"><span title="Opprette plan" class="linkLabel_WmDU">Opprette plan</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/rettigheter-og-roller-i-api-manager"><span title="Rettigheter, roller og grupper i API Manager" class="linkLabel_WmDU">Rettigheter, roller og grupper i API Manager</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/rolle-internrevisjon"><span title="Egne roller i Gravitee (f.eks. for innsyn)" class="linkLabel_WmDU">Egne roller i Gravitee (f.eks. for innsyn)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/se-bruk-av-api"><span title="Se bruken av ditt API" class="linkLabel_WmDU">Se bruken av ditt API</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/veiledere/api-manager/varsling-for-api-eiere"><span title="Varsling av nye subscriptions o.l." class="linkLabel_WmDU">Varsling av nye subscriptions o.l.</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/datadeling/veiledere/meldingskø/opprett-tjeneste"><span title="meldingskø" class="categoryLinkLabel_W154">meldingskø</span></a></div></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Datadeling</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/datadeling/veiledere/"><span>Veiledere i IntArk</span></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">api-manager</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Konfigurere autentisering via maskinporten </span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Konfigurere autentisering via maskinporten</h1></header>
<p>[Under utvikling: Anbefalingen vil endre seg, etter erfaringer med BOTT:ØL i 2021]</p>
<p>Hvordan du kan sette opp autentisering av ditt API via Maskinporten, når du trenger å snakke med API utenfor din organisasjon.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="bakgrunn">Bakgrunn<a href="#bakgrunn" class="hash-link" aria-label="Direct link to Bakgrunn" title="Direct link to Bakgrunn" translate="no">​</a></h3>
<p>Maskinporten kan brukes til sikker autentisering mot API på tvers av organisasjoner.</p>
<p>Når man bruker maskinporten autentiserer man seg først mot maskinporten med et sertifikat. Som svar får man et tilgans-token, som igjen brukes til autorisasjon i API Gatewayen.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="forutsetninger">Forutsetninger<a href="#forutsetninger" class="hash-link" aria-label="Direct link to Forutsetninger" title="Direct link to Forutsetninger" translate="no">​</a></h3>
<p>Det forutsettes at organisasjonen din er registrert som bruker av maskinporten og har fått opprettet et prefiks.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="registrer-api-i-maskinporten">Registrer API i Maskinporten<a href="#registrer-api-i-maskinporten" class="hash-link" aria-label="Direct link to Registrer API i Maskinporten" title="Direct link to Registrer API i Maskinporten" translate="no">​</a></h3>
<p>Først må API-et registreres i maskinporten. Da opprettes det et scope. Et scope kan brukes til å gi tilganger til ressurser i et eller flere API. Det anbefales å ikke bruke samme scope for å gi tilgang til ulike API.</p>
<p>I tillegg må de organisasjonene som skal få tilgang til API-et bli gitt tilgang. Dette kan gjøres både før og etter at API-et er registrert i API Gateway.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="registrer-api-et">Registrer API-et<a href="#registrer-api-et" class="hash-link" aria-label="Direct link to Registrer API-et" title="Direct link to Registrer API-et" translate="no">​</a></h3>
<p>Om det ikke allerede er registrert. Om det ikke allerede er gjort finnes det <a class="" href="/docs/datadeling/veiledere/api-manager/api-manager-registrere-enkelt-api">veiledning her</a>. Kom tilbake til denne siden når planer skal opprettes.</p>
<p>Opprett plan med sikret med JWT</p>
<p>Et tilgans-token er en type token som kalles Java Web Token, forkortet JWT (uttales jot eller jåt).</p>
<p>Opprett en ny plan ved å gå til API-et, velg Plans og trykk på plusstegnet</p>
<p><img decoding="async" loading="lazy" alt="webside for å opprette planer" src="/assets/images/image-20200928124644-1-b1764559e7b57ce2198043795e54e56c.png" width="838" height="374" class="img_ev3q"></p>
<p>Skriv inn navn og en beskrivelse av planen. Gå til neste side.</p>
<p>På siden for Secure, under Authentication velg JWT som Authentication type.</p>
<p><img decoding="async" loading="lazy" alt="Meny for vinduet Secure" src="/assets/images/image-20201012173900-1-6d0358441eec3fecdf17065005012149.png" width="1688" height="1205" class="img_ev3q"></p>
<p>Videre skal følgende legges til under Configuration.
I menyen for <strong>Signature</strong> la RS256 være valgt (det er eneste som støttes av maskinporten p.t.).</p>
<p>I menyen <strong>JWKS Resolver</strong>, velg JWKS_URL.</p>
<p>I <strong>Resolver parameter</strong> skriv eller lim inn URL hvor API Gatewayen kan finne maskinportens offentlige sertifikat. I produksjon er dette <a href="https://maskinporten.no/jwk" target="_blank" rel="noopener noreferrer" class="">https://maskinporten.no/jwk</a> , i test er det <code>https://test.maskinporten.no/jwk</code></p>
<p>Om du vil kunne bruke informasjon fra tokenet til flere sjekker og/eller i policyer, huk av for <strong>Extract JWT Claims</strong>.</p>
<p>Det er god praksis å sjekke autorisasjonen som er gitt både i API gateway og i selve API-et. Med mindre du ikke stoler på API-et eller det er for testing, lar du <strong>Propagate Authorization Header</strong> være huket av. Tilgangs-tokenet blir da sendt til backend-API-et, og samme eller en mer grundig sjekk av tokenet foretas der. Det vil og forhindre urettmessig tilgang til API-et dersom man spør backend-API-et direkte uten å gå via gatewayen.</p>
<p><strong>User claim</strong> fungerer ikke p.t. med maskinporten.</p>
<p><strong>Additional selection rules.</strong> Her kan det bli litt komplisert. Her kan man legge inn flere regler for å være sikker på at riktig plan blir valgt. Om API-et kun skal brukes av et scope kan du legge inn en sjekk av scope her. Er man sikker på at tokenet kun vil inneholde dette scopet, bruk f.eks:</p>
<div class="language-Text language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^org:test$&#x27;</span><br></span></code></pre></div></div>
<p>Vil man tillate at tokenet har andre scope i tilegg til det som gir tilgang til ditt API kan man bruke:</p>
<div class="language-Text language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^([a-z:\\s]\\s)?org:test(\\s[a-z:\\s])?$&#x27;</span><br></span></code></pre></div></div>
<p>Et litt mer avansert eksempel. Har man et API hvor man kan bli tildelt enten lese- og skriverettigheter, eller kun skrive- eller kun leserrettigheter.</p>
<p>Da kan man ha en plan for både lese og skrivetilgang med denne ekstra regelen:</p>
<div class="language-Text language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^([a-z:\\s]\\s)?org:test(\\s[a-z:\\s])?$&#x27; &amp;&amp; #context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^([a-z:\\s]\\s)?org:test.write(\\s[a-z:\\s])?$&#x27;</span><br></span></code></pre></div></div>
<p>Kun for skirvetilgang:</p>
<div class="language-Text language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^([a-z:\\s]\\s)?org:test.write(\\s[a-z:\\s])?$&#x27;</span><br></span></code></pre></div></div>
<p>Kun for lesetilgang:</p>
<div class="language-Text language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^([a-z:\\s]\\s)?org:test(\\s[a-z:\\s])?$&#x27;</span><br></span></code></pre></div></div>
<p>Merk at i dette eksempelet betyr rekkefølgen noe. Planer som krever to scope må være først i lista over tilgjengelige planer. På siden med oversikt over planer kan rekkefølgen endres.</p>
<p>Sjekke for flere grants</p>
<p>Det kan være tilfeller hvor man vil ha en plan per organisasjon. Det anbefales ikke om det er mange organisasjoner som skal ha tilgang, men det er mulig, og om det er et endelig lite antall er det overkommelig. For å legge inn regler som slår inn om det er riktig organisasjonsnummer og riktig scope:</p>
<div class="language-Text language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#context.attributes[&#x27;jwt&#x27;].claims[&#x27;consumer&#x27;][&#x27;ID&#x27;] == &#x27;0192:987654321&#x27; &amp;&amp; #context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^([a-z:\\s]\\s)?org:test(\\s[a-z:\\s])?$&#x27;</span><br></span></code></pre></div></div>
<p>Når alt er fylt inn, trykk &quot;NEXT&quot;.</p>
<p>For å legge inn rate-limit, kvoter, svartelisting, hvitelisting eller policy, , se <a class="" href="/docs/datadeling/veiledere/api-manager/opprette-plan">veiledningen for planer</a>.</p>
<p>Husk at planen må publiseres før den kan tas i bruk.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="registrere-applikasjon">Registrere applikasjon<a href="#registrere-applikasjon" class="hash-link" aria-label="Direct link to Registrere applikasjon" title="Direct link to Registrere applikasjon" translate="no">​</a></h3>
<p>For at en applikasjon skal kunne bruke API-et må applikasjonen registreres både i maskinporten og i Gravitee. Først må applikasjonen registreres som en integrasjon i maskinporten, og så må den <a class="" href="/docs/datadeling/veiledere/api-manager/api-manager-be-om-tilgang">registreres i Gravitee</a> med den client_id som den ble tildelt i maskinporten. Deretter kan applikasjonen søke om tilgang til riktig plan og API. Når tilgang er tildelt kan API-et benyttes. Man bruker ikke API-nøkkel og trenger ikke hente ut denne.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/sikt-no/docs/tree/master/docs/datadeling/veiledere/api-manager/maskinporten-autentisering.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-12-12T13:09:38.000Z" itemprop="dateModified">Dec 12, 2025</time></b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/datadeling/veiledere/api-manager/legge-pa-enkel-policy"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Legge på en enkel policy (IP filter)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/datadeling/veiledere/api-manager/opprette-plan"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Opprette plan</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#bakgrunn" class="table-of-contents__link toc-highlight">Bakgrunn</a></li><li><a href="#forutsetninger" class="table-of-contents__link toc-highlight">Forutsetninger</a></li><li><a href="#registrer-api-i-maskinporten" class="table-of-contents__link toc-highlight">Registrer API i Maskinporten</a></li><li><a href="#registrer-api-et" class="table-of-contents__link toc-highlight">Registrer API-et</a></li><li><a href="#registrere-applikasjon" class="table-of-contents__link toc-highlight">Registrere applikasjon</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Sikt Docs</div><ul class="footer__items clean-list"><li class="footer__item"><p>Teknisk dokumentasjon på fellesløsningene Sikt leverer for utdanning og forskning.</p></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Hvordan bidra?</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sikt-no/docs#editing-the-site-directly-from-the-web-browser" target="_blank" rel="noopener noreferrer" class="footer__link-item">Endre innholdet fra nettleseren</a></li><li class="footer__item"><a href="https://github.com/sikt-no/docs#editing-the-site-locally" target="_blank" rel="noopener noreferrer" class="footer__link-item">Endre innholdet lokalt</a></li><li class="footer__item"><a href="https://github.com/sikt-no/docs/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Opprette en issue i GitHub</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Kontaktinformasjon</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://sikt.no/kontakt-oss" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kontakt oss</a></li><li class="footer__item"><a href="https://sikt.no/om-sikt" target="_blank" rel="noopener noreferrer" class="footer__link-item">Om Sikt</a></li><li class="footer__item"><a href="https://sikt.no/personvernerklaering" target="_blank" rel="noopener noreferrer" class="footer__link-item">Personvernerklæring</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/sikt_logo_white.svg" alt="Sikt Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="104" height="28"><img src="/img/sikt_logo_white.svg" alt="Sikt Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="104" height="28"></div><div class="footer__copyright">Copyright © 2025 Sikt – Kunnskapssektorens tjenesteleverandør</div></div></div></footer></div>
</body>
</html>