<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-datadeling/teknisk-plattform/api/dfo-sap" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">DFØ SAP | Sikt teknisk dokumentasjon</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.sikt.no/docs/datadeling/teknisk-plattform/api/dfo-sap"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="DFØ SAP | Sikt teknisk dokumentasjon"><meta data-rh="true" name="description" content="Hjelp til oppsett av DFØ SAP sine REST API."><meta data-rh="true" property="og:description" content="Hjelp til oppsett av DFØ SAP sine REST API."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.sikt.no/docs/datadeling/teknisk-plattform/api/dfo-sap"><link data-rh="true" rel="alternate" href="https://docs.sikt.no/docs/datadeling/teknisk-plattform/api/dfo-sap" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.sikt.no/docs/datadeling/teknisk-plattform/api/dfo-sap" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.210d0366.css">
<script src="/assets/js/runtime~main.903324cc.js" defer="defer"></script>
<script src="/assets/js/main.5be8f7f2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/sikt_logo.svg" alt="Sikt logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/sikt_logo_white.svg" alt="Sikt logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">teknisk dokumentasjon</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/datadeling/">Datadeling</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/">Fellestjeneste for Datadeling (IntArk)</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/datadeling/om/">Hva er Fellestjenesten for Datadeling (IntArk)?</a><button aria-label="Expand sidebar category &#x27;Hva er Fellestjenesten for Datadeling (IntArk)?&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/datadeling/teknisk-plattform/">IntArk sin tekniske plattform</a><button aria-label="Collapse sidebar category &#x27;IntArk sin tekniske plattform&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/teknisk-plattform/oversikt">Oversikt over den tekniske plattformen</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/datadeling/teknisk-plattform/api/dfo-sap">api</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/datadeling/teknisk-plattform/api/dfo-sap">DFØ SAP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/teknisk-plattform/api/digdir">Digdir Folkeregisteret og KRR</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/teknisk-plattform/api/fs">Felles Studentsystem - FS-API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/teknisk-plattform/api/inspera">Inspera</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/teknisk-plattform/api/integra">Integra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/teknisk-plattform/api/maskinporten">Maskinporten som token-tjeneste i Gravitee</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/teknisk-plattform/api/rolf-api">Rolf - rolleregister</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/teknisk-plattform/brom">Selvbetjening for RabbitMQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/teknisk-plattform/gravitee">Gravitee</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/teknisk-plattform/infrastruktur">Infrastrukturen til IntArks tekniske plattform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/teknisk-plattform/prosessene">Prosessene for teknisk plattform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/teknisk-plattform/rabbitmq">RabbitMQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/datadeling/begreper/">Begreper i IntArk</a><button aria-label="Expand sidebar category &#x27;Begreper i IntArk&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/datadeling/erfaringer/">Erfaringer fra bruk av IntArk</a><button aria-label="Expand sidebar category &#x27;Erfaringer fra bruk av IntArk&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/faq">Spørsmål og svar</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/datadeling/god-praksis/">God praksis i fellestjenesten for Datadeling</a><button aria-label="Expand sidebar category &#x27;God praksis i fellestjenesten for Datadeling&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/kode">Kode som bruker IntArk</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/datadeling/malgrupper/anskaffer/">malgrupper</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/prinsippene">Integrasjonsprinsippene for IntArk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/styringsregler">Styringsreglene til IntArk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datadeling/unntak">Unntakshåndtering</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/datadeling/veiledere/">Veiledere i IntArk</a><button aria-label="Expand sidebar category &#x27;Veiledere i IntArk&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Datadeling</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/datadeling/teknisk-plattform/"><span itemprop="name">IntArk sin tekniske plattform</span></a><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">api</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">DFØ SAP</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>DFØ SAP</h1></header>
<p>Hjelp til oppsett av DFØ SAP sine REST API.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="om-api-ene">Om API-ene<a href="#om-api-ene" class="hash-link" aria-label="Direct link to Om API-ene" title="Direct link to Om API-ene">​</a></h2>
<p>DFØs løsninger for økonomi og lønn brukes av mange i sektoren. DFØ tilbyr API som er felles for sektoren, men der hver institusjon får ut sine data.</p>
<p>DFØ tilbyr flere ulike API-er for ulike data, som ansattinformasjon, stillingsdata og organisasjonsdata. Se <a href="https://api-portal.dfo.no/" target="_blank" rel="noopener noreferrer">DFØs API-portal</a> for mer informasjon.</p>
<p>For å kunne bruke DFØs API må din institusjon bli &quot;oppgradert&quot; hos DFØ. Mange institusjoner må i dag forholde seg til CSV-filer fra DFØ. Dette må gjøres i dialog med DFØ, og dette vil kunne ta tid.</p>
<p>DFØ krever autentisering via
<a href="https://samarbeid.digdir.no/maskinporten/maskinporten/25" target="_blank" rel="noopener noreferrer">Maskinporten</a> i sin
kommunikasjon, så institusjonen må registrere seg der før integrasjonen kan
påbegynnes. Maskinporten benytter <a href="https://www.ssh.com/academy/ssh/public-key-authentication" target="_blank" rel="noopener noreferrer">Public Key Authentication</a> for autentisering. Oppsettet innebærer at institusjonen genererer en hemmelig privat nøkkel til seg selv og en korresponderende offentlig nøkkel til Maskinporten. Den private nøkkelen brukes for å bekrefte identiteten til innehaveren, i dette tilfellet institusjonen. Den offentlige nøkkelen brukes av Maskinporten for å autentisere institusjonen og til å autorisere tilgang.</p>
<p>Som de fleste andre APIene settes APIet opp med autentisering mot vår API gateway, og deretter sendes requesten videre til backend-APIet. I API gatewayen legger vi på token og evt. API-nøkkel som brukes mot DFØs APIer. Tjenesten som utsteder token kan enten settes opp i Gravitee (<a href="/docs/datadeling/teknisk-plattform/api/maskinporten">se bruksanvisning her</a>) eller hos den enkelte institusjon</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="standardoppsett">Standardoppsett<a href="#standardoppsett" class="hash-link" aria-label="Direct link to Standardoppsett" title="Direct link to Standardoppsett">​</a></h2>
<p>DFØ er en fellestjeneste, og må/bør derfor settes opp likt hos alle institusjoner. Du kan sette dette opp ved å laste inn fil med standardoppsett:</p>
<p><a href="/assets/files/Lonnssystem-api-template-c2bb7618a89eb9664e1329b1d0449852.json" target="_blank">Lonnssystem-api-template.json</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hvordan-sette-opp-api-ene">Hvordan sette opp API-ene<a href="#hvordan-sette-opp-api-ene" class="hash-link" aria-label="Direct link to Hvordan sette opp API-ene" title="Direct link to Hvordan sette opp API-ene">​</a></h2>
<ol>
<li>
<p>Registrer din institusjon hos Maskinporten, <a href="https://samarbeid.digdir.no/maskinporten/konsument/119" target="_blank" rel="noopener noreferrer">se planleggingsaktiviteten her</a>. Registrer deretter en integrasjon i maskinporten, se veiledning her(<a href="https://docs.digdir.no/docs/Maskinporten/maskinporten_sjolvbetjening_web.html" target="_blank" rel="noopener noreferrer">https://docs.digdir.no/docs/Maskinporten/maskinporten_sjolvbetjening_web.html</a>) Sluttresultatet er at du har en integrasjon hvor du kan autentisere vha. virksomhetssertifikat eller et sertifikat du har laget selv (og som bare brukes mot denne integrasjonen) Integrasjonen må ha blitt tildelt de nødvendige scopes og du må ha issuer-ID tilgjengelig</p>
</li>
<li>
<p>Opprett tokentjeneste om du ikke har gjort det tidligere og gi APIet tilgang.</p>
<ul>
<li>Om du vil lage en i gravitee <a href="/docs/datadeling/teknisk-plattform/api/maskinporten">se veiledning her</a> Gi deretter SAP-APIet tilgang ved å opprette en applikasjon for dette og søk om tilgang til maskinporten-APIet. Når tilgangen er gitt får du en API-nøkkel som vi bruker i neste steg</li>
</ul>
</li>
<li>
<p>Last ned standardoppsettet over, og opprett tjenesten i API manager. Se <a href="/docs/datadeling/veiledere/api-manager/importer-api">veileder for å registrere en tjeneste i API manager via fil</a>.</p>
<ol>
<li>Gå inn i APIet og endre på Navn og beskrivelse</li>
<li>Gå til proxy -&gt; Entrypoint og evt. endre dette</li>
<li>Hvis prod: gå inn på proxy -&gt; backend services. Fjern &quot;-test&quot; fra URLen slik at det står <a href="https://api.dfo.no" target="_blank" rel="noopener noreferrer">https://api.dfo.no</a></li>
<li>Klikk på Design og policy-en HTTP Callout. Endre URL til den til tokentjenesten. Endre headeren X-Gravitee-Api-Key til nøkkelen fra punkt 2 om du har satt opp maskinporten-API i API Manager. Under headeren iss legger du inn ISSUER-ID for maskinporten-integrasjonen. Om du kjører token-tjenesten selv, konfigurer sikker autentisering og evt. headere/parametre etter behov.</li>
</ol>
</li>
<li>
<p>Registrer DFØ SAP som tjeneste i <em>Selvbetjeningsportalen for RabbitMQ</em> (se <a href="/docs/datadeling/veiledere/meldingskø/opprett-tjeneste">veileder for å registrere tjenesten</a>). Hent ut tilkoblingsdetaljene som det blir opplyst om.</p>
<ul>
<li>
<p>Om DFØ skal publisere meldinger direkte til deres RabbitMQ, send en forespørsel om etablering av notifikasjonsoverføring til <a href="mailto:it-support@dfo.no" target="_blank" rel="noopener noreferrer">it-support@dfo.no</a>. Legg ved tilkoblingsdetaljene som du finner i selvbetjeningsportalen. Passordet bør sendes via en sikker tredje kanal (<em>ikke</em> via e-post).</p>
</li>
<li>
<p>Om dere heller vil hente meldinger fra rabbitmq hos DFØ (eller en annen rabbitmq-installasjon) gjøres det vel å sette opp en shovel i rabbitMQ. Det finnes flere oppskrifter på hvordan man setter opp shovel. Her er oppskrift på en måte man kan sette det opp i rabbitMQ, mens man fremdeles gjør tilgangsstyring i BROM. Dette krever ekstra tilganger i rabbitMQ for å gjøre nødvendig oppsett.</p>
<ol>
<li>
<p>Registrer applikasjon i BROM. Velg at den skal publisere meldinger. Velg et godt navn og beskrivelse, dette er applikasjonen som utviklere abonnerer på om de vil ha meldinger fra deres SAP-installasjon</p>
</li>
<li>
<p>(Valgfritt) For å lett kunne se om shovel-en fungerer kan du opprette en applikasjon som abonnerer på meldinger fra applikasjonen du opprettet i forrige punkt. Godkjenn denne. Når shovelen fungerer vil det komme meldinger inn i meldingskøen for denne applikasjonen. Merk: denne bør slettes i ettertid.</p>
</li>
<li>
<p>Om IntArk-koordinator ikke har nødvendige rettigheter i rabbitMQ fra før,  kontakt support som oppretter bruker med nødvendinge rettigheter.</p>
</li>
<li>
<p>Sørg for å ha tilkoblingsinformasjon (brukernavn, passord, vhost, kø-navn, hostnavn) tilgjengelig</p>
</li>
<li>
<p>Logg inn i rabbitMQ med bruker som har rettigheter til å opprette shovel. I BROM er det link til innloggingsiden her: <img decoding="async" loading="lazy" alt="applikasjonsinfo i BROM" src="/assets/images/image-20211006190506-1-76008a2e1ddd40fbd524c65ba3682e6c.png" width="1143" height="671" class="img_ev3q"></p>
</li>
<li>
<p>Naviger til siden &quot;Admin&quot; og undemenyen &quot;Shovel Management&quot; <img decoding="async" loading="lazy" alt="webside for Shovel management i rabbitmq" src="/assets/images/rabbitmq-shovel-1-a1ca366ec6382f9218019e3e4f4b160a.png" width="1247" height="809" class="img_ev3q"></p>
</li>
<li>
<p>Under Add shovel, fyll ut:</p>
<ul>
<li>Velg vhost med samme navn som applikasjonen i punkt 1 (ikke nødvendig, men gjør det lettere å holde oversikt senere)</li>
<li>Gi et godt navn</li>
<li>Under source så er protocol nesten alltid AMQP 0.9.1, så det kan stå</li>
<li>source URI: adresse for å koble seg på DFØs rabbitmq riktig. Denne er litt komplisert. Den skal være amqps://BRUKERNAVN<!-- -->:PASSORD<!-- -->@mq.dfo.no/VHOST</li>
</ul>
<p><em>TIPS: lag denne i notepad eller annen tekstbehandler og bruk klipp og lim for å fylle inn i rabbitMQ. Feltet for dette i RabbitMQ er for kort til å se evt. feil</em></p>
<ul>
<li>source queue: navn på kø</li>
<li>destination URI: her er det samme rabbimtmq som vi er logget inn på, så denne er lettere Fyll inn amqp:///VHOST (hvor vhost er navnet på applikasjonen fra punkt 1) <em>OBS: merk at det er 3 skråstreker!</em></li>
<li>Endre fra queue til exchange</li>
<li>fyll inn navn på exchange. Det er outgoing_APPLIKASJONSNAVN (altså outgoing + underscore + navn på appliasjon. Du kan og se det under tilkoblingsdetaljer på publiseringsiden i brom)</li>
<li>routing key: La denne være blank. (Da vil meldingene beholde routing key som de har i kilden. Om du setter en verdi her til denne verdien overskrive eksisterende routing key)</li>
<li>Til sist trykk på &quot;add shovel&quot; Gå til siden &quot;Shovel status&quot; og se at shovlen du har laget endrer status til Started. Om den ikke endrer seg fra Starting til Started ila. et par minutter: sjekk tilkoblingsdetaljene, slett shovelen og opprett på nytt</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ol>
<p>API-et og meldingshåndtering er nå satt opp.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hvordan-verifisere-at-api-et-fungerer">Hvordan verifisere at API-et fungerer:<a href="#hvordan-verifisere-at-api-et-fungerer" class="hash-link" aria-label="Direct link to Hvordan verifisere at API-et fungerer:" title="Direct link to Hvordan verifisere at API-et fungerer:">​</a></h3>
<ol>
<li>
<p>Opprett din egen klient (applikasjon) i API manager, om du ikke har dette allerede.</p>
</li>
<li>
<p>Be om tilgang til API-et.</p>
</li>
<li>
<p>Godkjenn tilgangen til API-et. Du har nå fått en egen API-nøkkel for din klient.</p>
</li>
<li>
<p>Bruk klientens API-nøkkel, og sjekk at du får hentet ut data:</p>
<ul>
<li>Med curl (husk å endre det som står i uthevet tekst):</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl --include -H &quot;X-Gravitee-Api-Key: **API-nøkkel**&quot; https://gw-**INSTANS**.intark.uh-it.no/**lonn**/v1/organisasjoner/v1/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Med Powershell (husk å endre det som står i uthevet tekst):</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$headers = @{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;Accept&#x27; = &#x27;application/json&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;X-Gravitee-Api-Key&#x27; = **API-nøkkel**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Invoke-WebRequest -Headers $headers -Uri &quot;https://gw-**INSTANS**.intark.uh-it.no/**lonn**/v1/organisasjoner/v1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Hvis alt er ok kan du forvente å få tilbake noe som starter med &quot;HTTP 200&quot; og JSON-data.</li>
</ul>
</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/sikt-no/docs/tree/master/docs/datadeling/teknisk-plattform/api/dfo-sap.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-02-12T08:35:45.000Z" itemprop="dateModified">Feb 12, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/datadeling/teknisk-plattform/oversikt"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Oversikt over den tekniske plattformen</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/datadeling/teknisk-plattform/api/digdir"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Digdir Folkeregisteret og KRR</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#om-api-ene" class="table-of-contents__link toc-highlight">Om API-ene</a></li><li><a href="#standardoppsett" class="table-of-contents__link toc-highlight">Standardoppsett</a></li><li><a href="#hvordan-sette-opp-api-ene" class="table-of-contents__link toc-highlight">Hvordan sette opp API-ene</a><ul><li><a href="#hvordan-verifisere-at-api-et-fungerer" class="table-of-contents__link toc-highlight">Hvordan verifisere at API-et fungerer:</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Sikt Docs</div><ul class="footer__items clean-list"><li class="footer__item"><p>Teknisk dokumentasjon på fellesløsningene Sikt leverer for utdanning og forskning.</p></li></ul></div><div class="col footer__col"><div class="footer__title">Hvordan bidra?</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sikt-no/docs#editing-the-site-directly-from-the-web-browser" target="_blank" rel="noopener noreferrer" class="footer__link-item">Endre innholdet fra nettleseren</a></li><li class="footer__item"><a href="https://github.com/sikt-no/docs#editing-the-site-locally" target="_blank" rel="noopener noreferrer" class="footer__link-item">Endre innholdet lokalt</a></li><li class="footer__item"><a href="https://github.com/sikt-no/docs/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Opprette en issue i GitHub</a></li></ul></div><div class="col footer__col"><div class="footer__title">Kontaktinformasjon</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://sikt.no/kontakt-oss" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kontakt oss</a></li><li class="footer__item"><a href="https://sikt.no/om-sikt" target="_blank" rel="noopener noreferrer" class="footer__link-item">Om Sikt</a></li><li class="footer__item"><a href="https://sikt.no/personvernerklaering" target="_blank" rel="noopener noreferrer" class="footer__link-item">Personvernerklæring</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/sikt_logo_white.svg" alt="Sikt Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="104" height="28"><img src="/img/sikt_logo_white.svg" alt="Sikt Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="104" height="28"></div><div class="footer__copyright">Copyright © 2025 Sikt – Kunnskapssektorens tjenesteleverandør</div></div></div></footer></div>
</body>
</html>